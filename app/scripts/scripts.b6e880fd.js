d3.sankey=function(){var e={},i=24,l=8,c=[1,1],d=[],u=[];function a(){function e(t,e){return t.source.y-e.source.y}function a(t,e){return t.target.y-e.target.y}d.forEach(function(t){t.sourceLinks.sort(a),t.targetLinks.sort(e)}),d.forEach(function(t){var e=0,a=0;t.sourceLinks.forEach(function(t){t.sy=e,e+=t.dy}),t.targetLinks.forEach(function(t){t.ty=a,a+=t.dy})})}function p(t){return t.y+t.dy/2}function g(t){return t.value}return e.nodeWidth=function(t){return arguments.length?(i=+t,e):i},e.nodePadding=function(t){return arguments.length?(l=+t,e):l},e.nodes=function(t){return arguments.length?(d=t,e):d},e.links=function(t){return arguments.length?(u=t,e):u},e.size=function(t){return arguments.length?(c=t,e):c},e.layout=function(t){return d.forEach(function(t){t.sourceLinks=[],t.targetLinks=[]}),u.forEach(function(t){var e=t.source,a=t.target;"number"==typeof e&&(e=t.source=d[t.source]),"number"==typeof a&&(a=t.target=d[t.target]),e.sourceLinks.push(t),a.targetLinks.push(t)}),d.forEach(function(t){t.value=Math.max(d3.sum(t.sourceLinks,g),d3.sum(t.targetLinks,g))}),function(){var e,t=d,a=0;for(;t.length;)e=[],t.forEach(function(t){t.x=a,t.dx=i,t.sourceLinks.forEach(function(t){e.push(t.target)})}),t=e,++a;r=a,d.forEach(function(t){t.sourceLinks.length||(t.x=r-1)}),n=(c[0]-i)/(a-1),d.forEach(function(t){t.x*=n});var n;var r}(),function(t){var e=d3.nest().key(function(t){return t.x}).sortKeys(d3.ascending).entries(d).map(function(t){return t.values});a=d3.min(e,function(t){return(c[1]-(t.length-1)*l)/d3.sum(t,g)}),e.forEach(function(t){t.forEach(function(t,e){t.y=e,t.dy=t.value*a})}),u.forEach(function(t){t.dy=t.value*a}),o();var a;for(var n=1;0<t;--t)i(n*=.99),o(),r(n),o();function r(a){function n(t){return p(t.source)*t.value}e.forEach(function(t,e){t.forEach(function(t){if(t.targetLinks.length){var e=d3.sum(t.targetLinks,n)/d3.sum(t.targetLinks,g);t.y+=(e-p(t))*a}})})}function i(a){function n(t){return p(t.target)*t.value}e.slice().reverse().forEach(function(t){t.forEach(function(t){if(t.sourceLinks.length){var e=d3.sum(t.sourceLinks,n)/d3.sum(t.sourceLinks,g);t.y+=(e-p(t))*a}})})}function o(){e.forEach(function(t){var e,a,n,r=0,i=t.length;for(t.sort(s),n=0;n<i;++n)e=t[n],0<(a=r-e.y)&&(e.y+=a),r=e.y+e.dy+l;if(0<(a=r-l-c[1]))for(r=e.y-=a,n=i-2;0<=n;--n)e=t[n],0<(a=e.y+e.dy+l-r)&&(e.y-=a),r=e.y})}function s(t,e){return t.y-e.y}}(t),a(),e},e.relayout=function(){return a(),e},e.link=function(){var l=.5;function e(t){var e=t.source.x+t.source.dx,a=t.target.x,n=d3.interpolateNumber(e,a),r=n(l),i=n(1-l),o=t.source.y+t.sy+t.dy/2,s=t.target.y+t.ty+t.dy/2;return"M"+e+","+o+"C"+r+","+o+" "+i+","+s+" "+a+","+s}return e.curvature=function(t){return arguments.length?(l=+t,e):l},e},e},Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&"undefined"!=typeof exports?module.exports=e():t.Papa=e()}(this,function(){"use strict";var i,t,c="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==c?c:{},r=!c.document&&!!c.postMessage,s=r&&/(\?|&)papaworker(=|&|$)/.test(c.location.search),o=!1,l={},d=0,w={parse:function(t,e){var a=(e=e||{}).dynamicTyping||!1;if(G(a)&&(e.dynamicTypingFunction=a,a={}),e.dynamicTyping=a,e.transform=!!G(e.transform)&&e.transform,e.worker&&w.WORKERS_SUPPORTED){var n=function(){if(!w.WORKERS_SUPPORTED)return!1;if(!o&&null===w.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var t=w.SCRIPT_PATH||i;t+=(-1!==t.indexOf("?")?"&":"?")+"papaworker";var e=new c.Worker(t);return e.onmessage=b,e.id=d++,l[e.id]=e}();return n.userStep=e.step,n.userChunk=e.chunk,n.userComplete=e.complete,n.userError=e.error,e.step=G(e.step),e.chunk=G(e.chunk),e.complete=G(e.complete),e.error=G(e.error),delete e.worker,void n.postMessage({input:t,config:e,workerId:n.id})}var r=null;return t===w.NODE_STREAM_INPUT?(r=new v(e)).getStream():("string"==typeof t?r=e.download?new g(e):new f(e):!0===t.readable&&G(t.read)&&G(t.on)?r=new h(e):(c.File&&t instanceof File||t instanceof Object)&&(r=new m(e)),r.stream(t))},unparse:function(t,e){var a=!1,p=!0,g=",",m="\r\n",n='"',r=!1;"object"==typeof e&&("string"!=typeof e.delimiter||w.BAD_DELIMITERS.filter(function(t){return-1!==e.delimiter.indexOf(t)}).length||(g=e.delimiter),("boolean"==typeof e.quotes||Array.isArray(e.quotes))&&(a=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(r=e.skipEmptyLines),"string"==typeof e.newline&&(m=e.newline),"string"==typeof e.quoteChar&&(n=e.quoteChar),"boolean"==typeof e.header&&(p=e.header));var i=new RegExp(n,"g");if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return s(null,t,r);if("object"==typeof t[0])return s(o(t[0]),t,r)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:o(t.data[0])),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),s(t.fields||[],t.data||[],r);throw"exception: Unable to serialize unrecognized input";function o(t){if("object"!=typeof t)return[];var e=[];for(var a in t)e.push(a);return e}function s(t,e,a){var n="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var r=Array.isArray(t)&&0<t.length,i=!Array.isArray(e[0]);if(r&&p){for(var o=0;o<t.length;o++)0<o&&(n+=g),n+=f(t[o],o);0<e.length&&(n+=m)}for(var s=0;s<e.length;s++){var l=r?t.length:e[s].length,c=r?t:e[s];if("greedy"!==a||""!==c.join("").trim()){for(var d=0;d<l;d++){0<d&&(n+=g);var u=r&&i?t[d]:d;n+=f(e[s][u],d)}s<e.length-1&&(!a||0<l)&&(n+=m)}}return n}function f(t,e){return null==t?"":t.constructor===Date?JSON.stringify(t).slice(1,25):(t=t.toString().replace(i,n+n),"boolean"==typeof a&&a||Array.isArray(a)&&a[e]||function(t,e){for(var a=0;a<e.length;a++)if(-1<t.indexOf(e[a]))return!0;return!1}(t,w.BAD_DELIMITERS)||-1<t.indexOf(g)||" "===t.charAt(0)||" "===t.charAt(t.length-1)?n+t+n:t)}}};if(w.RECORD_SEP=String.fromCharCode(30),w.UNIT_SEP=String.fromCharCode(31),w.BYTE_ORDER_MARK="\ufeff",w.BAD_DELIMITERS=["\r","\n",'"',w.BYTE_ORDER_MARK],w.WORKERS_SUPPORTED=!r&&!!c.Worker,w.SCRIPT_PATH=null,w.NODE_STREAM_INPUT=1,w.LocalChunkSize=10485760,w.RemoteChunkSize=5242880,w.DefaultDelimiter=",",w.Parser=_,w.ParserHandle=a,w.NetworkStreamer=g,w.FileStreamer=m,w.StringStreamer=f,w.ReadableStreamStreamer=h,w.DuplexStreamStreamer=v,c.jQuery){var u=c.jQuery;u.fn.parse=function(o){var a=o.config||{},s=[];return this.each(function(t){if("INPUT"!==u(this).prop("tagName").toUpperCase()||"file"!==u(this).attr("type").toLowerCase()||!c.FileReader||!this.files||0===this.files.length)return!0;for(var e=0;e<this.files.length;e++)s.push({file:this.files[e],inputElem:this,instanceConfig:u.extend({},a)})}),t(),this;function t(){if(0!==s.length){var t,e,a,n=s[0];if(G(o.before)){var r=o.before(n.file,n.inputElem);if("object"==typeof r){if("abort"===r.action)return"AbortError",t=n.file,e=n.inputElem,a=r.reason,void(G(o.error)&&o.error({name:"AbortError"},t,e,a));if("skip"===r.action)return void l();"object"==typeof r.config&&(n.instanceConfig=u.extend(n.instanceConfig,r.config))}else if("skip"===r)return void l()}var i=n.instanceConfig.complete;n.instanceConfig.complete=function(t){G(i)&&i(t,n.file,n.inputElem),l()},w.parse(n.file,n.instanceConfig)}else G(o.complete)&&o.complete()}function l(){s.splice(0,1),t()}}}function p(t){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=k(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new a(e),(this._handle.streamer=this)._config=e}.call(this,t),this.parseChunk=function(t,e){if(this.isFirstChunk&&G(this._config.beforeFirstChunk)){var a=this._config.beforeFirstChunk(t);void 0!==a&&(t=a)}this.isFirstChunk=!1;var n=this._partialLine+t;this._partialLine="";var r=this._handle.parse(n,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var i=r.meta.cursor;this._finished||(this._partialLine=n.substring(i-this._baseIndex),this._baseIndex=i),r&&r.data&&(this._rowCount+=r.data.length);var o=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)c.postMessage({results:r,workerId:w.WORKER_ID,finished:o});else if(G(this._config.chunk)&&!e){if(this._config.chunk(r,this._handle),this._handle.paused()||this._handle.aborted())return;r=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(r.data),this._completeResults.errors=this._completeResults.errors.concat(r.errors),this._completeResults.meta=r.meta),this._completed||!o||!G(this._config.complete)||r&&r.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),o||r&&r.meta.paused||this._nextChunk(),r}},this._sendError=function(t){G(this._config.error)?this._config.error(t):s&&this._config.error&&c.postMessage({workerId:w.WORKER_ID,error:t,finished:!1})}}function g(t){var n;(t=t||{}).chunkSize||(t.chunkSize=w.RemoteChunkSize),p.call(this,t),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(n=new XMLHttpRequest,this._config.withCredentials&&(n.withCredentials=this._config.withCredentials),r||(n.onload=T(this._chunkLoaded,this),n.onerror=T(this._chunkError,this)),n.open("GET",this._input,!r),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var e in t)n.setRequestHeader(e,t[e])}if(this._config.chunkSize){var a=this._start+this._config.chunkSize-1;n.setRequestHeader("Range","bytes="+this._start+"-"+a),n.setRequestHeader("If-None-Match","webkit-no-cache")}try{n.send()}catch(t){this._chunkError(t.message)}r&&0===n.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){var t;4===n.readyState&&(n.status<200||400<=n.status?this._chunkError():(this._finished=!this._config.chunkSize||this._start>(null===(t=n.getResponseHeader("Content-Range"))?-1:parseInt(t.substr(t.lastIndexOf("/")+1))),this.parseChunk(n.responseText)))},this._chunkError=function(t){var e=n.statusText||t;this._sendError(new Error(e))}}function m(t){var n,r;(t=t||{}).chunkSize||(t.chunkSize=w.LocalChunkSize),p.call(this,t);var i="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,r=t.slice||t.webkitSlice||t.mozSlice,i?((n=new FileReader).onload=T(this._chunkLoaded,this),n.onerror=T(this._chunkError,this)):n=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var e=Math.min(this._start+this._config.chunkSize,this._input.size);t=r.call(t,this._start,e)}var a=n.readAsText(t,this._config.encoding);i||this._chunkLoaded({target:{result:a}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(n.error)}}function f(t){var a;p.call(this,t=t||{}),this.stream=function(t){return a=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,e=t?a.substr(0,t):a;return a=t?a.substr(t):"",this._finished=!a,this.parseChunk(e)}}}function h(t){p.call(this,t=t||{});var e=[],a=!0,n=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):a=!0},this._streamData=T(function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),a&&(a=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this),this._streamError=T(function(t){this._streamCleanUp(),this._sendError(t)},this),this._streamEnd=T(function(){this._streamCleanUp(),n=!0,this._streamData("")},this),this._streamCleanUp=T(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function v(t){var e=require("stream").Duplex,a=k(t),n=!0,r=!1,i=[],o=null;this._onCsvData=function(t){for(var e=t.data,a=0;a<e.length;a++)o.push(e[a])||this._handle.paused()||this._handle.pause()},this._onCsvComplete=function(){o.push(null)},a.step=T(this._onCsvData,this),a.complete=T(this._onCsvComplete,this),p.call(this,a),this._nextChunk=function(){r&&1===i.length&&(this._finished=!0),i.length?i.shift()():n=!0},this._addToParseQueue=function(t,e){i.push(T(function(){if(this.parseChunk("string"==typeof t?t:t.toString(a.encoding)),G(e))return e()},this)),n&&(n=!1,this._nextChunk())},this._onRead=function(){this._handle.paused()&&this._handle.resume()},this._onWrite=function(t,e,a){this._addToParseQueue(t,a)},this._onWriteComplete=function(){r=!0,this._addToParseQueue("")},this.getStream=function(){return o},(o=new e({readableObjectMode:!0,decodeStrings:!1,read:T(this._onRead,this),write:T(this._onWrite,this)})).once("finish",T(this._onWriteComplete,this))}function a(h){var o,s,l,c=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,d=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,e=this,a=0,u=0,p=!1,t=!1,g=[],m={data:[],errors:[],meta:{}};if(G(h.step)){var n=h.step;h.step=function(t){if(m=t,r())f();else{if(f(),0===m.data.length)return;a+=t.data.length,h.preview&&a>h.preview?s.abort():n(m,e)}}}function v(t){return"greedy"===h.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function f(){if(m&&l&&(b("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+w.DefaultDelimiter+"'"),l=!1),h.skipEmptyLines)for(var t=0;t<m.data.length;t++)v(m.data[t])&&m.data.splice(t--,1);return r()&&function(){if(m){for(var t=0;r()&&t<m.data.length;t++)for(var e=0;e<m.data[t].length;e++){var a=m.data[t][e];h.trimHeaders&&(a=a.trim()),g.push(a)}m.data.splice(0,1)}}(),function(){if(!m||!h.header&&!h.dynamicTyping&&!h.transform)return m;for(var t=0;t<m.data.length;t++){var e,a=h.header?{}:[];for(e=0;e<m.data[t].length;e++){var n=e,r=m.data[t][e];h.header&&(n=e>=g.length?"__parsed_extra":g[e]),h.transform&&(r=h.transform(r,n)),i=r,o=void 0,o=n,h.dynamicTypingFunction&&void 0===h.dynamicTyping[o]&&(h.dynamicTyping[o]=h.dynamicTypingFunction(o)),r=!0===(h.dynamicTyping[o]||h.dynamicTyping)?"true"===i||"TRUE"===i||"false"!==i&&"FALSE"!==i&&(c.test(i)?parseFloat(i):d.test(i)?new Date(i):""===i?null:i):i,"__parsed_extra"===n?(a[n]=a[n]||[],a[n].push(r)):a[n]=r}m.data[t]=a,h.header&&(e>g.length?b("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+e,u+t):e<g.length&&b("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+e,u+t))}var i,o;return h.header&&m.meta&&(m.meta.fields=g),u+=m.data.length,m}()}function r(){return h.header&&0===g.length}function b(t,e,a,n){m.errors.push({type:t,code:e,message:a,row:n})}this.parse=function(t,e,a){var n=h.quoteChar||'"';if(h.newline||(h.newline=function(t,e){t=t.substr(0,1048576);var a=new RegExp(y(e)+"([^]*?)"+y(e),"gm"),n=(t=t.replace(a,"")).split("\r"),r=t.split("\n"),i=1<r.length&&r[0].length<n[0].length;if(1===n.length||i)return"\n";for(var o=0,s=0;s<n.length;s++)"\n"===n[s][0]&&o++;return o>=n.length/2?"\r\n":"\r"}(t,n)),l=!1,h.delimiter)G(h.delimiter)&&(h.delimiter=h.delimiter(t),m.meta.delimiter=h.delimiter);else{var r=function(t,e,a,n){for(var r,i,o,s=[",","\t","|",";",w.RECORD_SEP,w.UNIT_SEP],l=0;l<s.length;l++){var c=s[l],d=0,u=0,p=0;o=void 0;for(var g=new _({comments:n,delimiter:c,newline:e,preview:10}).parse(t),m=0;m<g.data.length;m++)if(a&&v(g.data[m]))p++;else{var f=g.data[m].length;u+=f,void 0!==o?1<f&&(d+=Math.abs(f-o),o=f):o=f}0<g.data.length&&(u/=g.data.length-p),(void 0===i||d<i)&&1.99<u&&(i=d,r=c)}return{successful:!!(h.delimiter=r),bestDelimiter:r}}(t,h.newline,h.skipEmptyLines,h.comments);r.successful?h.delimiter=r.bestDelimiter:(l=!0,h.delimiter=w.DefaultDelimiter),m.meta.delimiter=h.delimiter}var i=k(h);return h.preview&&h.header&&i.preview++,o=t,s=new _(i),m=s.parse(o,e,a),f(),p?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return p},this.pause=function(){p=!0,s.abort(),o=o.substr(s.getCharIndex())},this.resume=function(){p=!1,e.streamer.parseChunk(o,!0)},this.aborted=function(){return t},this.abort=function(){t=!0,s.abort(),m.meta.aborted=!0,G(h.complete)&&h.complete(m),o=""}}function y(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function _(t){var $,A=(t=t||{}).delimiter,O=t.newline,D=t.comments,E=t.step,S=t.preview,F=t.fastMode,R=$=void 0===t.quoteChar?'"':t.quoteChar;if(void 0!==t.escapeChar&&(R=t.escapeChar),("string"!=typeof A||-1<w.BAD_DELIMITERS.indexOf(A))&&(A=","),D===A)throw"Comment character same as delimiter";!0===D?D="#":("string"!=typeof D||-1<w.BAD_DELIMITERS.indexOf(D))&&(D=!1),"\n"!==O&&"\r"!==O&&"\r\n"!==O&&(O="\n");var I=0,j=!1;this.parse=function(n,e,a){if("string"!=typeof n)throw"Input must be a string";var r=n.length,t=A.length,i=O.length,o=D.length,s=G(E),l=[],c=[],d=[],u=I=0;if(!n)return k();if(F||!1!==F&&-1===n.indexOf($)){for(var p=n.split(O),g=0;g<p.length;g++){if(d=p[g],I+=d.length,g!==p.length-1)I+=O.length;else if(a)return k();if(!D||d.substr(0,o)!==D){if(s){if(l=[],y(d.split(A)),T(),j)return k()}else y(d.split(A));if(S&&S<=g)return l=l.slice(0,S),k(!0)}}return k()}for(var m,f=n.indexOf(A,I),h=n.indexOf(O,I),v=new RegExp(R.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")+$,"g");;)if(n[I]!==$)if(D&&0===d.length&&n.substr(I,o)===D){if(-1===h)return k();I=h+i,h=n.indexOf(O,I),f=n.indexOf(A,I)}else if(-1!==f&&(f<h||-1===h))d.push(n.substring(I,f)),I=f+t,f=n.indexOf(A,I);else{if(-1===h)break;if(d.push(n.substring(I,h)),C(h+i),s&&(T(),j))return k();if(S&&l.length>=S)return k(!0)}else for(m=I,I++;;){if(-1===(m=n.indexOf($,m+1)))return a||c.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:l.length,index:I}),x();if(m===r-1)return x(n.substring(I,m).replace(v,$));if($!==R||n[m+1]!==R){if($===R||0===m||n[m-1]!==R){var b=_(-1===h?f:Math.min(f,h));if(n[m+1+b]===A){d.push(n.substring(I,m).replace(v,$)),I=m+1+b+t,f=n.indexOf(A,I),h=n.indexOf(O,I);break}var w=_(h);if(n.substr(m+1+w,i)===O){if(d.push(n.substring(I,m).replace(v,$)),C(m+1+w+i),f=n.indexOf(A,I),s&&(T(),j))return k();if(S&&l.length>=S)return k(!0);break}c.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:l.length,index:I}),m++}}else m++}return x();function y(t){l.push(t),u=I}function _(t){var e=0;if(-1!==t){var a=n.substring(m+1,t);a&&""===a.trim()&&(e=a.length)}return e}function x(t){return a||(void 0===t&&(t=n.substr(I)),d.push(t),I=r,y(d),s&&T()),k()}function C(t){I=t,y(d),d=[],h=n.indexOf(O,I)}function k(t){return{data:l,errors:c,meta:{delimiter:A,linebreak:O,aborted:j,truncated:!!t,cursor:u+(e||0)}}}function T(){E(k()),l=[],c=[]}},this.abort=function(){j=!0},this.getCharIndex=function(){return I}}function b(t){var e=t.data,a=l[e.workerId],n=!1;if(e.error)a.userError(e.error,e.file);else if(e.results&&e.results.data){var r={abort:function(){n=!0,x(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:C,resume:C};if(G(a.userStep)){for(var i=0;i<e.results.data.length&&(a.userStep({data:[e.results.data[i]],errors:e.results.errors,meta:e.results.meta},r),!n);i++);delete e.results}else G(a.userChunk)&&(a.userChunk(e.results,r,e.file),delete e.results)}e.finished&&!n&&x(e.workerId,e.results)}function x(t,e){var a=l[t];G(a.userComplete)&&a.userComplete(e),a.terminate(),delete l[t]}function C(){throw"Not implemented."}function k(t){if("object"!=typeof t||null===t)return t;var e=Array.isArray(t)?[]:{};for(var a in t)e[a]=k(t[a]);return e}function T(t,e){return function(){t.apply(e,arguments)}}function G(t){return"function"==typeof t}return s?c.onmessage=function(t){var e=t.data;if(void 0===w.WORKER_ID&&e&&(w.WORKER_ID=e.workerId),"string"==typeof e.input)c.postMessage({workerId:w.WORKER_ID,results:w.parse(e.input,e.config),finished:!0});else if(c.File&&e.input instanceof File||e.input instanceof Object){var a=w.parse(e.input,e.config);a&&c.postMessage({workerId:w.WORKER_ID,results:a,finished:!0})}}:w.WORKERS_SUPPORTED&&(t=document.getElementsByTagName("script"),i=t.length?t[t.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){o=!0},!0):o=!0),(g.prototype=Object.create(p.prototype)).constructor=g,(m.prototype=Object.create(p.prototype)).constructor=m,(f.prototype=Object.create(f.prototype)).constructor=f,(h.prototype=Object.create(p.prototype)).constructor=h,(v.prototype=Object.create(p.prototype)).constructor=v,w});var getMontoRange=function(t){var e=25e9;return _.inRange(t,0,e)?"monto_0_50":_.inRange(t,e,5e10)?"monto_50_100":_.inRange(t,5e10,1e11)?"monto_100_150":"monto_mas_50"},jurisdiccionesIds={},jurisdiccionesCounter=1,cleanData=function(t,e,a){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r.toLowerCase()]=t[r]);n.compromiso="SI"==n.compromiso,n.jurisdiccion&&n.jurisdiccion.toString().trim().length&&(jurisdiccionesIds[n.jurisdiccion]||(jurisdiccionesIds[n.jurisdiccion]=jurisdiccionesCounter,jurisdiccionesCounter+=1),n.jurisdiccion_id=jurisdiccionesIds[n.jurisdiccion]);var i=n.comuna?n.comuna.split("|"):[null];n.comuna=i[0],n.comuna=n.comuna?parseInt(n.comuna.toString().trim()):n.comuna,n.comuna||(n.comuna_from_jurisdiccion=!0,n.comuna=n.jurisdiccion_id),n.barrio=n.barrio?n.barrio.split("|"):[],n.licitacion_oferta_empresa=n.licitacion_oferta_empresa?n.licitacion_oferta_empresa:null,n.mano_obra=n.mano_obra?parseInt(n.mano_obra):null,n.id=parseInt(n.id||e),n.licitacion_anio=n.licitacion_anio?parseInt(n.licitacion_anio.toString().trim()):null,n.monto_contrato=n.monto_contrato?parseFloat(n.monto_contrato.toString().replace(/[$]+/g,"").trim()):null,n.licitacion_presupuesto_oficial=n.licitacion_presupuesto_oficial?parseFloat(n.licitacion_presupuesto_oficial.toString().trim()):null,n.plazo_meses=n.plazo_meses?parseInt(n.plazo_meses.toString().trim()):null,n.porcentaje_avance=n.porcentaje_avance?n.porcentaje_avance.toString().trim():"",n.porcentaje_avance.toString().trim(),n.porcentaje_avance=isNaN(n.porcentaje_avance)?"":n.porcentaje_avance,n.porcentaje_avance=n.porcentaje_avance?parseFloat(n.porcentaje_avance):null,n.porcentaje_avance="Finalizada"===n.etapa?100:n.porcentaje_avance,n.hideDates="En proyecto"===n.etapa||"En licitación"===n.etapa||!n.fecha_inicio||!n.fecha_fin_inicial,n.fotos=[];for(var o=1;o<=4;o++){n[r="imagen_"+o]&&(n.fotos[o-1]=n[r])}return n.thumb=n.fotos[0]||"",n.entorno_slug=n.entorno?a.slugify(n.entorno.toString().trim()):null,n.etapa_slug=n.etapa?a.slugify(n.etapa.toString().trim()):null,n.tipo_slug=n.tipo?a.slugify(n.tipo.toString().trim()):null,n.entorno=n.entorno?n.entorno:null,n.area_slug=n.area_responsable?a.slugify(n.area_responsable.toString().trim()):null,n.red_slug=n.red?a.slugify(n.red.toString().trim()):null,n.monto_slug=n.monto_contrato?getMontoRange(n.monto_contrato):null,n.hasDetail=!!(n.etapa||n.etapa_detalle||n.tipo||n.area_responsable||n.licitacion_oferta_empresa||n.porcentaje_avance||n.plazo_meses||n.licitacion_anio||n.beneficiarios||n.mano_obra||n.monto_contrato||n.licitacion_presupuesto_oficial||n.pliego_descarga),n};function loadData(t,e,a,n){if(!window.MDUYT_CONFIG)throw"Archivo de configuración inexistente";var r,i=e.defer(),o=function(t){r=(r=window.MDUYT_CONFIG.LOAD_USING_JSONP?t.data:"andino-json-api"===window.MDUYT_CONFIG.DATA_ORIGIN?t.data.result.records:Papa.parse(t.data,{header:!0}).data).map(function(t,e){return cleanData(t,e,n)}),i.resolve(r)},s=function(t){r=t,i.reject(t)},l=t.trustAsResourceUrl(window.MDUYT_CONFIG.DATA_PATH);return window.MDUYT_CONFIG.LOAD_USING_JSONP?a.jsonp(l).then(o,s):a.get(l).then(o,s),i.promise}function fetchId(t){t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);var e=t.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/);if(null!==e)return e[1]}function getYoutubePic(t){return"https://img.youtube.com/vi/"+fetchId(t)+"/hqdefault.jpg;"}window._i18n={loading:"Cargando",title:"Seguimiento Ciudadano de Obras",subtitle:"Seguimiento Ciudadano de Obras",homeTitle:"Seguimiento Ciudadano de Obras",homeButton:"Principal",searchButton:"Buscar Obras",jurisdictionName:"Localidad",seeJurisdictionButton:"Ver localidad",worksWithoutJurisdictionTitle:"Sin localidad asignada",homeIframeTitle:"Seguimiento Ciudadano de Obras",closeButton:"Cerrar",noResults:"No hay resultados",plannedWork:"Obra",company:"Contratista",investmentAmount:"Presupuesto",description:"Descripción",responsableArea:"Agencia",type:"Tipo",commune:"Localidad",stage:"Etapa",moreInformation:"Más información",environment:"Ambiente",mapLocation:"Mapa",mapTitle:"Ver obras de la localidad",mobileMapTitle:"Tocá sobre una localidad para conocer las obras",searchBy:"Buscar por",featuredWorks:"",seeMore:"Ver más",governmentCommitment:"Compromiso del gobierno",technicalInformation:"Información Técnica",featuredWork:"Proyecto",start:"Comienzo",end:"Finalización",workType:"Tipo de proyecto",contractType:"Tipo de contrato",contractNumber:"Nº de contrato",termDuration:"Duración",months:"meses",yearOfTender:"Año de licitación",numberOfBeneficiaries:"Número de beneficiarios",people:"Trabajadores",workforce:"Mano de obra",contractAmount:"Monto del contrato",address:"Dirección",updatedAmount:"Presupuesto actualizado",financer:"Patrocinador",contractInformation:"Enviar comentarios",environmentalImpact:"Impacto ambiental",workLocation:"Ubicación del proyecto",plannedWorks:"Proyectos",ofTheTotal:"del total",all:"todos",filterByGovernmentArea:"Filtrar por Agencia",totalWorks:"Proyectos totales",ended:"Finalzados",employees:"Empleados",upTo50Millions:"hasta 25 mil millones de pesos colombianos",from50To100Millions:"de 25 a 50  mil millones de pesos colombianos",from100To150Millions:"de 50 a100 mil millones de pesos colombianos",moreThan150Millions:"más de 100 mil millones de pesos colombianos"},angular.module("obrasMduytApp",["ngRoute","ngSanitize","slugifier","angular-flexslider","leaflet-directive","ngYoutubeEmbed","ngTable"]).config(["$routeProvider","$logProvider","$httpProvider","$locationProvider","$provide","$sceDelegateProvider",function(t,e,a,n,r,i){t.when("/home",{templateUrl:"views/home.html",controller:"HomeCtrl",controllerAs:"home"}).when("/buscador",{templateUrl:"views/buscador.html",controller:"BuscadorCtrl",controllerAs:"buscador"}).when("/obra/:id",{templateUrl:"views/obra.html",controller:"ObraCtrl",controllerAs:"obra"}).when("/entorno/:entorno",{templateUrl:"views/entorno.html",controller:"EntornoCtrl",controllerAs:"entorno"}).otherwise({redirectTo:"/home"}),e.debugEnabled(!1),n.hashPrefix(""),r.decorator("$locale",["$delegate",function(t){return t.NUMBER_FORMATS.DECIMAL_SEP=",",t.NUMBER_FORMATS.GROUP_SEP=".",t}]),i.resourceUrlWhitelist(["self","*://ws.usig.buenosaires.gob.ar/**"])}]).service("DataService",["$http","$q","Slug","$sce",function(a,r,t,n){var i,o;this.getById=function(e){var a,n=r.defer();return this.retrieveAll().then(function(t){a=t.filter(function(t){return t.id===parseInt(e)}),n.resolve(a[0])}),a=n.promise,r.when(a)},this.getByEntorno=function(e){var a,n=r.defer();return this.retrieveAll().then(function(t){a=t.filter(function(t){return t.entorno_slug===e}),n.resolve(a)}),a=n.promise,r.when(a)},this.getAll=function(){var t,e=r.defer();return this.retrieveAll().then(function(t){e.resolve(t)}),t=e.promise,r.when(t)},this.getMapas=function(){var t,e=r.defer();return this.retrieveMapas().then(function(t){e.resolve(t)}),t=e.promise,r.when(t)},this.retrieveMapas=function(){var t=function(){if(!window.MDUYT_CONFIG)throw"Archivo de configuración inexistente";var t;return"GET_REQUEST"===window.MDUYT_CONFIG.LOAD_USING?t=window.MDUYT_CONFIG.MAPAS_CSV:"JSONP_PROXY"===window.MDUYT_CONFIG.LOAD_USING&&(t=window.MDUYT_CONFIG.JSON_PROXY+"?source_format=csv&source="+window.MDUYT_CONFIG.MAPAS_CSV),n.trustAsResourceUrl(t)}(),e=r.defer();return""==t&&(o=[]),o||(a.jsonp(t).then(function(t){o=t.data,e.resolve(o)},function(t){console.log("error: ",t),i=t,e.reject(t)}),o=e.promise),r.when(o)},this.retrieveAll=function(){return i||(i=loadData(n,r,a,t)),r.when(i)}}]).filter("capitalize",function(){return function(t){return t?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():""}}).filter("cleanunderscore",function(){return function(t){return t.replace(/_/g," ")}}).run(function(){}),angular.module("obrasMduytApp").directive("progressLine",function(){return{restrict:"E",replace:!0,scope:{callback:"=callback",class:"=class"},controller:["$scope","$timeout","$http",function(g,t,e){g.loading=!0;var a,n=function(){var t=g.obra,e=moment(t.fecha_inicio),a=moment(t.fecha_fin_inicial),n=moment(),r=d3.scale.linear().domain([0,100]).range([e.valueOf(),a.valueOf()]),i=n.valueOf(),o=parseFloat(t.porcentaje_avance);o<100&&(i=r(o));var s,l,c,d=[{label:"Category 1",value:i}],u=document.querySelectorAll(".chart")[0].clientWidth,p=d3.scale.linear().domain([e.valueOf(),a.valueOf()]).range([0,u]);a.valueOf();d3.select(".chart").html(""),(s=(c=d3.select(".chart").append("svg").attr("width",u).attr("height",55)).selectAll("g").data(d).enter().append("g")).attr("class","bar").attr("cx",0).attr("transform",function(t,e){return"translate(0,"+(5*e+0)+")"}),l=p,d3.svg.axis().scale(l).tickSize(2).orient("bottom"),s.append("rect").attr("transform","translate(0, 15)").attr("height",1).attr("width",function(t){return l(r(100))}),c.append("g").append("text").attr("class","value").attr("y",30).attr("x",0).attr("dx",0).attr("dy","0").attr("text-anchor","start").text("Inicio"),c.append("g").append("text").attr("class","value").attr("y",45).attr("x",0).attr("dx",0).attr("dy","0").attr("text-anchor","start").text(e.format("MM-YYYY")),c.append("g").append("text").attr("class","value").attr("y",30).attr("x",u).attr("dx",0).attr("dy","0").attr("text-anchor","end").text("Fin"),c.append("g").append("text").attr("class","value").attr("y",45).attr("x",u).attr("dx",0).attr("dy","0").attr("text-anchor","end").text(a.format("MM-YYYY"))};g.resizeFunction=n,g.callback(function(t){g.obra=t,setTimeout(n,100)}),$(window).resize(function(){clearTimeout(a),a=setTimeout(function(){g.resizeFunction&&g.resizeFunction()},500)})}],template:'<div class="chart"></div>'}}),angular.module("obrasMduytApp").directive("coloredIcons",function(){return{restrict:"E",replace:!0,scope:{callback:"=callback",scale:"=scale",class:"=class"},controller:["$scope","$element","$timeout","$http",function(o,s,t,e){o.loading=!0;o.scale;o.id="content-"+Math.floor(1e4*Math.random());o.id;o.callback(function(i){s[0].clientWidth;setTimeout(function(){d3.select(s[0]).html("");var t=d3.select(s[0]).append("svg").attr("viewBox","0 0 100 16"),r=t.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("y1","100%").attr("y2","0%").attr("spreadMethod","pad");r.append("svg:stop").attr("offset","0%").attr("stop-color","#f1662f").attr("stop-opacity",1),t.append("defs").append("g").attr("id","iconCustom").append("path").attr("d","M3.5,2H2.7C3,1.8,3.3,1.5,3.3,1.1c0-0.6-0.4-1-1-1c-0.6,0-1,0.4-1,1c0,0.4,0.2,0.7,0.6,0.9H1.1C0.7,2,0.4,2.3,0.4,2.6v1.9c0,0.3,0.3,0.6,0.6,0.6h0.2c0,0,0,0.1,0,0.1v1.9c0,0.3,0.2,0.6,0.3,0.6h1.3c0.2,0,0.3-0.3,0.3-0.6V5.3c0,0,0-0.1,0-0.1h0.2c0.3,0,0.6-0.3,0.6-0.6V2.6C4.1,2.3,3.8,2,3.5,2z"),t.append("rect").attr("width",100).attr("height",10).attr("fill","#efefef");var e=d3.range(22);t.append("text").attr("id","txtValue").attr("x",1).attr("y",15).attr("dy",0).text("Manzana"),t.append("text").attr("id","txtValue").attr("x",30).attr("y",15).attr("dy",0).text("Barrio"),t.append("text").attr("id","txtValue").attr("x",60).attr("y",15).attr("dy",0).text("Comuna"),t.append("text").attr("id","txtValue").attr("x",85.5).attr("y",15).attr("dy",0).text("Ciudad"),t.append("g").attr("id","pictoLayer").selectAll("use").data(e).enter().append("use").attr("xlink:href","#iconCustom").attr("id",function(t){return"icon"+t}).attr("x",function(t){return 2+t%22*4.3}).attr("y",function(t){return 1+4.3*Math.floor(t/22)}).classed("iconPlain",!0);var a=1,n=1;"manoDeObra"===o.scale&&(a=20,n=i.mano_obra),"beneficiarios"===o.scale&&(a=5e4,n=i.benficiarios),function(t){t.percent;var a=t.percent/100*22,n=a%1;d3.selectAll("use").attr("fill",function(t,e){return t<a-1?"#f1662f":a-1<t&&t<a?(r.append("svg:stop").attr("offset",100*n+"%").attr("stop-color","#f1662f").attr("stop-opacity",1),r.append("svg:stop").attr("offset",100*n+"%").attr("stop-color","#aaa").attr("stop-opacity",1),r.append("svg:stop").attr("offset","100%").attr("stop-color","#aaa").attr("stop-opacity",1),"url(#gradient)"):"#aaa"})}({percent:100*n/(22*a)})},300)})}],template:"<div class='colored'></div>"}}),angular.module("obrasMduytApp").directive("selectorHome",function(){return{restrict:"E",scope:{list:"=",updateFn:"&",selectedGroup:"="},template:"<div id='selector-home' class='row' ng-show='selectedGroup'><div ng-repeat='(key, g) in list' class='col-xs-3 selector' ng-class='{\"selectorSelected\":selectedGroup==g.id}'><a ng-click='updateFn({group:g.id})'><img ng-src=\"{{'images/selectores/'+g.id+'.svg'}}\"/><span>{{g.name}}</span></a></div></div>",replace:!0,link:function(t,e,a){}}}),angular.module("obrasMduytApp").directive("statsHome",["$timeout","$interval",function(t,r){return{restrict:"E",scope:{obras:"="},templateUrl:"views/includes/stats-home.html",replace:!0,link:function(a,t,e){var n;a.i18n=window._i18n,a.total={inversion:0,obras:0,finalizadas:0,mano_obra:0,porcentaje_finalizadas:0},a.totalTemp=angular.copy(a.total),a.totalRender=angular.copy(a.total);a.$watch(e.obras,function(t){t&&(n=angular.copy(t),_.map(n,function(t){a.total.obras+=1,t.monto_contrato&&(a.total.inversion+=t.monto_contrato),t.mano_obra&&(a.total.mano_obra+=t.mano_obra),100==t.porcentaje_avance&&(a.total.finalizadas+=1,a.total.porcentaje_finalizadas=Math.round(100*a.total.finalizadas/a.total.obras))}),function(){a.counter_steps=20,a.current_step=0;var t=r(function(){a.counter_steps==a.current_step?r.cancel(t):(angular.forEach(a.total,function(t,e){a.totalTemp[e]=a.totalRender[e]+a.total[e]/a.counter_steps}),a.totalRender=angular.copy(a.totalTemp)),a.current_step++},200)}())})}}}]),angular.module("obrasMduytApp").directive("tipoChart",function(){return{restrict:"E",scope:{labels:"=",obras:"=",filterFn:"&",finishFn:"&",selectedFilter:"=",tipoColors:"="},template:"<div class='row chart-item'><div id='tipo-chart' ng-show='total_obras_by_tipo.length'><div class='col-md-2'><h4>Filtrar por Tipo</h4></div></div><div class='col-md-2'><p></p></div><div class='col-md-10 label-slug'><h3></h3></div></div>",replace:!0,link:function(o,t,e){var a,n=!1,s="",r=0;$(window).load(function(){r=$(window).width()});var i={};function l(){i.w=d3.select("#tipo-chart").node().getBoundingClientRect().width,i.margin=i.w/100,i.barh=40,i.gap=10,i.h=o.total_obras_by_tipo.length*(i.barh+i.gap)+2*i.gap,i.tipo_chart_container||(i.tipo_chart_container=d3.select("#tipo-chart").append("div").attr("id","tipo-chart-container").classed("col-md-10",!0),i.groups=i.tipo_chart_container.selectAll("div.tipo-group").data(o.total_obras_by_tipo),i.groups.enter().append("div").attr("id",function(t){return"tipo-group-"+t.slug}).classed("tipo-group",!0).each(function(r){var t=d3.select(this).append("a").datum(r).classed("tipo-container",!0).on("click",function(t){o.filterFn({filter:t.slug}),n?n&&s!=t.slug?($(".label-slug h3").html(o.labels[t.slug]),s=t.slug):n&&s==t.slug&&($(".label-slug h3").html(""),n=!1):($(".label-slug h3").html(o.labels[t.slug]),s=t.slug,n=!0)}),i=t.append("div").classed("image-container",!0);t.append("span").datum(r).classed("tipo-text",!0).attr("fill","#fff").text(function(){return r.tipo}),d3.xml("images/iconos/"+r.slug+".svg",function(t,e){if(t)console.error(t);else{var a=e.getElementsByTagName("svg")[0];i.node().appendChild(a);var n=o.tipoColors(r.tipo);i.select("svg").attr("height",50).attr("width",50).selectAll("path,rect").attr("fill",n)}})})),o.finishFn()}o.$watch(e.obras,function(t){var e;t&&"object"==typeof t&&(a=t,e=_.groupBy(a.filter(function(t){return void 0!==t.tipo}),"tipo"),o.total_obras_by_tipo=_.orderBy(_.reduce(e,function(t,e,a){return t.push({tipo:a,slug:e[0].tipo_slug,cantidad:e.length}),t},[]),"cantidad","desc"),l(),window.$(window).resize(function(){r!=$(window).width()&&(clearTimeout(o.timeoutId),o.timeoutId=setTimeout(function(){l()},1e3))}))}),o.$watch(e.selectedFilter,function(t){i.groups&&function(){if(o.selectedFilter){var t=i.tipo_chart_container.select("#tipo-group-"+o.selectedFilter);t.empty()?i.tipo_chart_container.selectAll(".tipo-group").classed("selected",!1):(i.tipo_chart_container.selectAll(".tipo-group").classed("selected",!1),t.classed("selected",!0))}else i.tipo_chart_container.selectAll(".tipo-group").classed("selected",!1)}()})}}}),angular.module("obrasMduytApp").directive("etapaChart",function(){return{restrict:"E",scope:{obras:"=",filterFn:"&",selectedFilter:"=",tipoColors:"="},template:"<div id='etapa-chart'></div>",replace:!0,link:function(r,t,e){var a,n=0;$(window).load(function(){n=$(window).width()});var i={};function o(){i.w=d3.select("#etapa-chart").node().getBoundingClientRect().width,i.margin=i.w/100,i.barh=40,i.gap=10,i.h=2*i.barh+2*i.gap,i.svg||(i.svg=d3.select("#etapa-chart").append("svg"),i.mainGroup=i.svg.append("g").classed("main-group",!0),i.selection=i.mainGroup.append("rect").classed("selection",!0).attr("height",i.gap+i.barh).attr("x",i.w).attr("y",i.barh).attr("fill","#ffbc00"),i.pipe=i.mainGroup.append("line").classed("pipe",!0).attr("height",i.h).attr("y1",i.barh/2).attr("y2",2*i.barh+2*i.gap).attr("fill","black").attr("stroke","black").attr("stroke-width",1)),i.max=d3.max(r.obras_by_etapa,function(t){return t.cantidad}),i.scale=d3.scale.linear().domain([0,i.max]).range([0,i.w/2-2*i.gap]),i.svg.attr("width",i.w).attr("height",i.h),i.selection.attr("width",i.w/2-i.gap),i.groups=i.mainGroup.selectAll("g.etapa-group").data(r.obras_by_etapa),i.pipe.attr("x1",i.w/2).attr("x2",i.w/2),i.groups.enter().append("g").attr("id",function(t){return"etapa-group-"+t.slug}).classed("etapa-group",!0).each(function(t,e){var a=d3.select(this);t.index=e,_.map(t.obras,function(t){return t.index=e,t}),a.selectAll("rect.etapa-rect").data(t.obras).enter().append("rect").classed("etapa-rect",!0).attr("y",i.barh+i.gap).attr("height",i.barh).attr("fill",function(t){return r.tipoColors(t.tipo)}),a.append("text").datum(t).classed("etapa-text",!0).attr("fill","#000").attr("y",i.barh).text(function(){return t.etapa}).attr("text-anchor",function(){return 0==e?"end":"start"}),a.append("rect").datum(t).classed("click-rect",!0).attr("fill","red").attr("fill-opacity",0).on("click",function(t){r.filterFn({filter:t.slug})})});var n={g0:i.scale(i.max)+i.gap,g1:i.gap};i.groups.selectAll("rect.etapa-rect").attr("width",function(t){return i.scale(t.cantidad)}).attr("x",function(t){var e=t.cantidad,a=0==t.index?Math.abs(i.scale(e)-n["g"+t.index]):i.scale(0)+n["g"+t.index];return n["g"+t.index]=0==t.index?n["g"+t.index]-i.scale(e):n["g"+t.index]+i.scale(e),a}),i.groups.selectAll("text.etapa-text").attr("x",function(t){return 0==t.index?i.w/2-i.gap:i.gap}),i.groups.selectAll("rect.click-rect").attr("width",i.w/2).attr("height",2*i.barh+2*i.gap),i.groups.transition().attr("transform",function(t,e){return"translate("+(0==e?0:i.w/2)+",0)"})}r.$watch(e.obras,function(t){t&&(a=t,r.obras_by_etapa=_.map(_.groupBy(a.filter(function(t){return void 0!==t.etapa}),"etapa"),function(t,e){var a=_.groupBy(t.filter(function(t){return void 0!==t.tipo}),"tipo"),n={slug:t[0].etapa_slug,etapa:t[0].etapa,obras:_.orderBy(_.reduce(a,function(t,e,a){return t.push({tipo:a,slug:e[0].tipo_slug,cantidad:e.length}),t},[]),"cantidad","desc")};return n.cantidad=d3.sum(n.obras,function(t){return t.cantidad}),n}),o())}),r.$watch(e.selectedFilter,function(t){i.groups&&function(){if(r.selectedFilter){var t=i.mainGroup.select("#etapa-group-"+r.selectedFilter);if(t.empty())i.selection.transition().attr("x",i.w);else{var e=d3.transform(t.attr("transform")),a=e.translate[0],n=e.translate[1];i.selection.transition().attr("x",a+i.gap/2).attr("y",n+i.barh+i.gap/2)}}else i.selection.transition().attr("x",i.w)}()}),window.$(window).resize(function(){n!=$(window).width()&&(clearTimeout(r.timeoutId),r.timeoutId=setTimeout(function(){o()},1e3))})}}}),angular.module("obrasMduytApp").directive("areaResponsableChart",function(){return{restrict:"E",scope:{obras:"=",filterFn:"&",selectedFilter:"="},templateUrl:"views/includes/home-area.html",replace:!0,link:function(n,t,e){n.i18n=window._i18n;var a,r=0;$(window).load(function(){r=$(window).width()});var i={};function o(){i.w=d3.select("#area-responsable-chart #mini-chart").node().getBoundingClientRect().width,i.margin=i.w/100,i.barh=27,i.gap=2,i.h=i.barh+2*i.gap,i.svg||(i.svg=d3.select("#area-responsable-chart #mini-chart").append("svg"),i.mainGroup=i.svg.append("g").classed("main-group",!0)),n.total=d3.sum(n.total_obras_by_area,function(t){return t.cantidad}),n.selectedCantidad=n.total,i.scale=d3.scale.linear().domain([0,n.total]).range([0,i.w-(n.total_obras_by_area.length+2*i.gap)]),i.svg.attr("width",i.w).attr("height",i.h),i.groups=i.mainGroup.selectAll("g.area-group").data(n.total_obras_by_area),i.groups.enter().append("g").attr("id",function(t){return"area-group-"+t.slug}).classed("area-group",!0).each(function(t){var e=d3.select(this);e.append("rect").datum(t).classed("area-rect",!0).attr("x",i.gap),e.append("rect").datum(t).classed("click-rect",!0).attr("x",i.gap).on("click",function(t){n.filterFn({filter:t.slug})})}),i.groups.selectAll("rect.area-rect").attr("height",i.barh).attr("width",function(t){return i.scale(t.cantidad)}),i.groups.selectAll("rect.click-rect").attr("height",i.barh).attr("width",function(t){return i.scale(t.cantidad)});var a=0;i.groups.transition().attr("transform",function(t){var e=a;return a=a+i.scale(t.cantidad)+i.scale(i.gap),"translate("+e+",0)"})}n.$watch(e.obras,function(t){t&&(a=t,function(){var t=_.groupBy(a.filter(function(t){return void 0!==t.area_responsable}),"area_responsable");n.total_obras_by_area=_.orderBy(_.reduce(t,function(t,e,a){return t.push({area:a,slug:e[0].area_slug,cantidad:e.length}),t},[]),"cantidad","desc"),n.total_obras_by_area_key=_.groupBy(n.total_obras_by_area,"slug");d3.select("#area-responsable-chart #areas").on("change",function(t){var e=d3.select("#area-responsable-chart #areas").property("value");n.filterFn({filter:e})});o()}())}),n.$watch(e.selectedFilter,function(t){i.groups&&function(){if(i.mainGroup.selectAll(".area-rect").classed("selected",!1),n.total_obras_by_area_key[n.selectedFilter]){n.selected=n.selectedFilter;var t=i.mainGroup.select("#area-group-"+n.selectedFilter).select(".area-rect");t.empty()||t.classed("selected",!0),n.selectedCantidad=n.total_obras_by_area_key[n.selectedFilter][0].cantidad}else n.selected="",n.selectedCantidad=n.total}()}),n.selected="",window.$(window).resize(function(){r!=$(window).width()&&(clearTimeout(n.timeoutId),n.timeoutId=setTimeout(function(){o()},1e3))})}}}),angular.module("ngYoutubeEmbed",[]).directive("ngYoutubeEmbed",[function(){return{restrict:"E",template:'<div ng-bind-html="youtubeEmbedFrame"></div>',scope:{url:"=",playauto:"@playauto",autohide:"@autohide",ccloadpolicy:"@ccloadpolicy",color:"@color",controls:"@controls",disablekb:"@disablekb",end:"@end",fs:"@fs",hl:"@hl",ivloadpolicy:"@ivloadpolicy",playlist:"@playlist",playsinline:"@playsinline",rel:"@rel",showinfo:"@showinfo",start:"@start",theme:"@theme",width:"@width",height:"@height"},controller:["$scope","$sce",function(t,e){var a=t.url;if(void 0!==a){if(t.playlistArray=[],void 0!==t.playlist)for(var n=t.playlist.split(","),r=0;r<n.length;r++)t.playlistArray.push(fetchId(n[r]));var i,o,s,l,c,d,u,p,g,m,f,h,v,b,w;i="true"===t.playauto?1:0,o="true"===t.autohide?1:0,s="true"===t.ccloadpolicy?1:0,l="white"===t.color?"white":"red",c="false"===t.controls?0:1,d="false"===t.disablekb?0:1,u=t.end,p="false"===t.fs?0:1,g=t.hl,"false"===t.ivloadpolicy?0:1,m=t.playlistArray,f="true"===t.playsinline?1:0,h="false"===t.rel?0:1,v="false"===t.showinfo?0:1,b=t.start,w=t.theme;var y="<iframe width="+(void 0!==t.width?t.width:"500px")+" height="+(void 0!==t.height?t.height:"350px")+' src="https://www.youtube.com/embed/'+fetchId(a)+"?autoplay="+i+"&autohide="+o+"&cc_load_policy="+s+"&color="+l+"&controls="+c+"&disablekb="+d+"&end="+u+"&fs="+p+"&hl="+g+"&playlist="+m+"&playsinline="+f+"&rel="+h+"&showinfo="+v+"&start="+b+"&theme="+w+'" frameborder="0" allowfullscreen></iframe>';t.youtubeEmbedFrame=e.trustAsHtml(y)}}]}}]),angular.module("obrasMduytApp").controller("HomeCtrl",["$scope","DataService","$filter","$http","$sce",function(c,t,e,d,u){c.i18n=window._i18n;var p=window.d3;c.loading=!0,c.pymChild=new window.pym.Child({polling:1e3});var g={},l={},a="";p.xml("images/iconos/compromiso.svg",function(t,e){a=e}),c.tipo_colors=function(t){var e=[];return e["Espacio Público"]="#A7C64D",e.Escuelas="#7874B2",e.Salud="#F1AD3C",e.Arquitectura="#38A0D7",e["Hidráulica e Infraestructura"]="#BD3E93",e.Transporte="#E84D00",e.Vivienda="#22B496",e[t]},c.selectedGroup=!1,c.oldGroup="mapa",c.selectedObra=!1;var m={};c.selectedFilter=!1,c.labels={},c.selectTypes=[];var n={label:"-Todas las Obras",slug:""};c.obrasTypeFilter=n,c.selectTypes.push(n),c.selectTypes.push({label:"Espacio Público",slug:"espacio-publico"}),c.selectTypes.push({label:"Escuelas",slug:"escuelas"}),c.selectTypes.push({label:"Salud",slug:"salud"}),c.selectTypes.push({label:"Arquitectura",slug:"arquitectura"}),c.selectTypes.push({label:"Vivienda",slug:"vivienda"}),c.selectTypes.push({label:"Transporte",slug:"transporte"}),c.selectTypes.push({label:"Hidráulica e Infraestructura",slug:"hidraulica-e-infraestructura"}),c.labels["espacio-publico"]="Obras e intervenciones en el espacio público, tales como obras en plazas y parques, en veredas o de regeneración urbana.",c.labels.escuelas="Obras de construcción, refacción o puesta en valor de establecimientos educativos.",c.labels.arquitectura="Obras civiles de reforma, puesta en valor o construcción de edificios.",c.labels.salud="Obras de construcción, remodelación y puesta en valor en hospitales y centros de salud y atención comunitaria..",c.labels.vivienda="Construcción de viviendas nuevas y obras de mejoras en viviendas existentes.",c.labels.transporte="Obras de infraestructura destinadas al transporte público y a la construcción y mantenimiento de las vías de circulación. ",c.labels["hidraulica-e-infraestructura"]="Comprende obras e intervenciones relacionadas con el tratamiento de fluidos (cursos de agua o desagües pluviales), así como obras de equipamiento, redes sanitarias, de gas o electricidad, necesarias para la vida en un entorno urbano.",c.selectedRadioDimension="monto_contrato",c.tooltip=p.select("#tooltip-home-chart"),c.pymChild.sendHeight();var r={comunas:x,montos:O,etapas:R,mapa:function(){p.json("geo/geometry.geojson",function(t){var e=t&&t.properties&&t.properties.center?t.properties.center:[-58.43992,-34.618],a=t&&t.properties&&t.properties.zoomLevel?t.properties.zoomLevel:240;function n(){c.isSmallDevice&&g.svg.attr("height",g.w),g.mapGroup.selectAll("path.map-item").style("display","block").style("stroke-width",0).transition().duration(1e3).style("stroke-width",3).attr("d",g.mapPath).style("opacity",1),g.mapGroup.selectAll("text.map-text").attr("x",function(t){return g.mapPath.centroid(t)[0]}).attr("y",function(t){return g.mapPath.centroid(t)[1]}).style("opacity",1).style("display","block")}g.mapProjection=p.geo.mercator().center(e).translate([g.w/2,g.h/2]).scale(a*g.w),g.mapPath=p.geo.path().projection(g.mapProjection),g.mapGroup||(g.mapGroup=g.svg.select("#map-group"),g.mapCentroids={},g.mapFeatures=t.features,f.each(g.mapFeatures,function(t,e){g.mapCentroids["mapa-comuna-"+(t.properties&&t.properties.comuna?t.properties.comuna:e)]=g.mapPath.centroid(t)}),g.mapGroup.selectAll("path.map-item").data(g.mapFeatures).enter().append("path").classed("child",!0).classed("map-item",!0).attr("id",function(t,e){return"mapa-comuna-"+(t.properties&&t.properties.comuna?t.properties.comuna:e)}).classed("shape",!0).on("click",y),g.mapGroup.selectAll("text.map-text").data(g.mapFeatures).enter().append("text").attr("class","map-text").classed("child",!0).attr("text-anchor","middle").attr("x",function(t){return g.mapPath.centroid(t)[0]}).attr("y",function(t){return g.mapPath.centroid(t)[1]}).text(function(t,e){return t.properties&&t.properties.comuna?t.properties.comuna:""})),n()})}},i={comunas:C,montos:D,etapas:I,mapa:function(){l.clusters={},l.clusterPoints={},l.nodesComuna=[],l.nodes=c.obras.filter(function(t){return t.lat&&t.lng}).map(function(t){var e="i"+t.id,a=c.isSmallDevice?1.25:4,n={cluster:e,radius:a,data:t};l.clusters[e]=n;var r=g.mapProjection([parseFloat(t.lng),parseFloat(t.lat)]);return l.clusterPoints[e]={x:r[0],y:r[1],radius:c.isSmallDevice?1.25:4},n}),l.scale=!1}},o={comunas:A,montos:S,etapas:G,mapa:_},s={comunas:!1,montos:!1,etapas:!1,mapa:!1},f=window._,h=0;function v(){g.w=p.select("#home-chart-container").node().getBoundingClientRect().width,g.w=(!g.svg||g.w,g.w),c.isSmallDevice=g.w<700,c.isSmallDevice?(g.w=$(window).width(),g.h=$(window).width()):(g.h=g.w,g.margin=g.w/200),g.svg||(g.svg=p.select("#home-chart-container").append("svg"),g.mainGroup=g.svg.append("g").classed("main-group",!0),g.mainGroup.append("rect").attr("fill","white"),g.svg.append("g").attr("id","comunas-group"),g.svg.append("g").attr("id","map-group"),g.svg.append("g").attr("id","etapas-group"),g.svg.append("g").attr("id","montos-group"),l.group=g.svg.append("g").attr("id","bubbles-group"),l.icons=g.svg.append("g").attr("id","bubbles-icons"),c.isSmallDevice&&p.selectAll("#bubbles-group").style("display","none"),g.selection=g.svg.append("circle").attr("class","selection-cicle").attr("cx",0).attr("cy",0).attr("r",0).style("fill","none").style("stroke","black").style("stroke-width",2)),g.svg.attr("width",g.w).attr("height",g.h),g.mainGroup.select("rect").attr("width",g.w).attr("height",g.h),c.showGroup()}function b(r,i,o){var s=Math.floor(g.w/i),l=0,c=0;r.transition().duration(700).attr("transform",function(t,e){var a=l*i,n=c*o;return l<s-1?l++:r[0].length!==e+1&&(l=0,c++),"translate("+a+","+n+")"})}$(window).load(function(){h=$(window).width()}),t.getAll().then(function(t){c.obras=t,c.selectedGroup="mapa",c.useComunas=!0;for(var e=0;e<c.obras.length;e++)c.obras[e].comuna_from_jurisdiccion&&(c.useComunas=!1);c.availableGroups=[{id:"mapa",name:"Mapa"},{id:"comunas",name:c.useComunas?"Comunas":"Jurisdicciones"},{id:"montos",name:"Inversión"},{id:"etapas",name:"Etapas"}],c.loading=!1,setTimeout(function(){v()},1e3),window.$(window).resize(function(){h!=$(window).width()&&(clearTimeout(c.timeoutId),c.timeoutId=setTimeout(function(){s={comunas:!1,montos:!1,etapas:!1,mapa:!1},v()},1e3))})}),c.textFilter="",c.$watch("textFilter",function(t,e){c.loading||c.filterByText()}),c.filterByText=function(){c.textFilter=$(".text-filter").val(),3<c.textFilter.length&&c.filterBubbles(c.selectedFilter,c.textFilter),0===c.textFilter.length&&c.filterBubbles(c.selectedFilter)},c.filterBubbles=function(t){if(c.selectedFilter==t&&(p.selectAll("circle.obra").style("opacity",1),p.selectAll("g.banderita").style("opacity",1),t=!1),""==t&&""==c.textFilter)p.selectAll("circle.obra").style("opacity",1),p.selectAll("g.banderita").style("opacity",1);else if(""==c.textFilter)p.selectAll("circle.obra").style("opacity",.2),p.selectAll("g.banderita").style("opacity",.2),p.selectAll("circle.obra."+t).style("opacity",1),p.selectAll("g.banderita."+t).style("opacity",1);else{p.selectAll("circle.obra").style("opacity",.2);for(var e=c.textFilter.toLowerCase().split(" "),a=0;a<e.length;a++){var n="";""!=t&&(n+="."+t),n+="."+e[a],p.selectAll("circle.obra"+n).style("opacity",1),p.selectAll("g.banderita"+n).style("opacity",1)}}c.selectedFilter=t,c.closeTooltip(),c.$$phase||c.$apply()},c.changeGroup=function(t){c.selectedGroup=t,c.showGroup()},c.showGroup=function(){c.oldGroup!==c.selectedGroup&&(c.closeTooltip(),o[c.oldGroup](!0),g.svg.selectAll(".child").style("opacity",0).style("display","none"),g.svg.selectAll("circle.obra").transition().style("opacity",.5),c.oldGroup=c.selectedGroup),r[c.selectedGroup]();var t=s[c.selectedGroup]||"mapa"===c.selectedGroup?100:2e3;s[c.selectedGroup]=!0,setTimeout(function(){i[c.selectedGroup](),L()},t)};var w=p.select(null);function y(t){if(c.closeTooltip(),w.node()===this)return _();if(w.classed("active",!1),w=p.select(this).classed("active",!0),c.isSmallDevice)c.$apply(function(){c.showList=!0,c.selectedComuna=t.properties&&t.properties.comuna,c.selectedJurisdiccion=t.properties&&t.properties.id,c.filteredObras=c.obras.filter(function(t){return c.selectedComuna?parseInt(t.comuna)===parseInt(c.selectedComuna):t.jurisdiccion===c.selectedJurisdiccion})});else{var e=g.mapPath.bounds(t),a=e[1][0]-e[0][0],n=e[1][1]-e[0][1],r=(e[0][0]+e[1][0])/2,i=(e[0][1]+e[1][1])/2,o=.9/Math.max(a/g.w,n/g.h),s=[g.w/2-o*r,g.h/2-o*i];g.mapGroup.transition().duration(750).attr("transform","translate("+s+")scale("+o+")"),g.mapGroup.selectAll("path").transition().duration(750).style("stroke-width","1px"),g.selection.transition().duration(750).attr("transform","translate("+s+")scale("+o+")"),l.group.transition().duration(750).attr("transform","translate("+s+")scale("+o+")"),l.icons.transition().duration(750).attr("transform","translate("+s+")scale("+o+")")}}function _(){c.isSmallDevice&&p.selectAll("#bubbles-group").style("display","none"),w.classed("active",!1),w=p.select(null),g.mapGroup.transition().duration(750).attr("transform",""),g.selection.transition().duration(750).attr("transform",""),g.mapGroup.selectAll("path").transition().duration(750).style("stroke-width","3px"),l.icons.transition().duration(750).attr("transform",""),l.group.transition().duration(750).attr("transform","")}function x(t){var a,n,e=[],r=[];if(c.useComunas){e=p.range(1,16);for(var i=0;i<e.length;i++)r[e[i]]="Comuna "+e[i]}else{for(var o=0;o<c.obras.length;o++)c.obras[o].jurisdiccion&&-1===r.indexOf(c.obras[o].jurisdiccion)&&(r[c.obras[o].comuna]=c.obras[o].jurisdiccion,e.push(c.obras[o].jurisdiccion_id));e.sort(function(t,e){return r[t]>r[e]?1:r[t]<r[e]?-1:0})}c.isSmallDevice?(a=g.w,n=g.w,g.svg.attr("height",e.length*g.w),g.mainGroup.select("rect").attr("height",e.length*g.w)):(a=g.h/Math.ceil(e.length/5),n=g.w/5),g.comunasGroup||(g.comunasGroup=g.svg.select("#comunas-group"),g.comunasGroup.selectAll("g.comunas-item").data(e).enter().append("g").classed("child",!0).classed("comunas-item",!0).style("opacity",0).attr("transform",function(t,e){return"translate("+(g.w/2-n/2)+","+(g.h/2-a/2)+")"}).attr("id",function(t){return"comunas-item-"+t}).each(function(){var t=p.select(this);t.append("rect").classed("comunas-item-frame",!0).on("click",T),t.append("text").classed("comunas-item-text",!0).attr("fill","#000").text(function(t){return r[t]})})),t||g.comunasGroup.selectAll("g.comunas-item").style("display","block"),g.comunasGroup.selectAll("rect.comunas-item-frame").transition().duration(700).attr("x",g.margin).attr("y",g.margin).attr("height",a-2*g.margin).attr("width",n-2*g.margin),g.comunasGroup.selectAll("text.comunas-item-text").transition().duration(700).attr("x",15).attr("y",25),b(g.comunasGroup.selectAll("g.comunas-item").transition().duration(1e3).style("opacity",1),n,a)}function C(t){l.clusters={},l.clusterPoints={};var r=!!t&&t.replace("comunas-item-",""),e=c.obras.filter(function(t){return!r||r&&parseInt(t.comuna)===parseInt(r)}),a=Math.ceil(p.max(e,function(t){return t[c.selectedRadioDimension]})),n=Math.floor(p.min(e,function(t){return t[c.selectedRadioDimension]}));l.scale=p.scale.linear().domain([parseInt(n),parseInt(a)]).range([10,r?100:50]),l.nodes=e.filter(function(t){return t.comuna&&(!r||r&&parseInt(t.comuna)===parseInt(r))}).map(function(t){var e="c"+t.comuna,a=r?10:5,n={cluster:e,radius:a||10,data:t};return(!l.clusters[e]||a>l.clusters[e].radius)&&(l.clusters[e]=n),n}),p.selectAll("g.comunas-item").each(function(t){var e=p.select(this),a=e.select("rect");l.clusterPoints["c"+t]={x:p.transform(e.attr("transform")).translate[0]+a.attr("width")/2,y:p.transform(e.attr("transform")).translate[1]+a.attr("height")/2,radius:20}})}var k=p.select(null);function T(t){if(!c.isSmallDevice){if(c.closeTooltip(),k.node()===this)return A();k.classed("active",!1);var e=(k=p.select(this).classed("active",!0)).node().parentNode;p.selectAll("g.comunas-item").transition().style("opacity",function(){return this===e?1:0}).each("end",function(){this!==e&&p.select(this).style("display","none")}),k.transition().duration(750).attr("height",g.h-2*g.margin).attr("width",g.w-2*g.margin),p.select(e).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){C(p.select(e).attr("id")),L()})}}function A(t){k.classed("active",!1),k=p.select(null),p.selectAll("g.comunas-item").style("display","block"),x(t),t||setTimeout(function(){C(),L()},2e3)}function O(t){var a,n,e=["monto_0_50","monto_50_100","monto_100_150","monto_mas_50"],r={monto_0_50:c.i18n.upTo50Millions,monto_50_100:c.i18n.from50To100Millions,monto_100_150:c.i18n.from100To150Millions,monto_mas_50:c.i18n.moreThan150Millions};c.isSmallDevice?(a=g.w,n=g.w,g.svg.attr("height",e.length*g.w),g.mainGroup.select("rect").attr("height",e.length*g.w)):(a=g.h/2,n=g.w/2),g.montosGroup||(g.montosGroup=g.svg.select("#montos-group"),g.montosGroup.selectAll("g.montos-item").data(e).enter().append("g").classed("child",!0).classed("montos-item",!0).style("opacity",0).attr("transform",function(t,e){return"translate("+(g.w/2-n/2)+","+(g.h/2-a/2)+")"}).attr("id",function(t){return"montos-item-"+t}).each(function(){var t=p.select(this);t.append("rect").classed("montos-item-frame",!0).on("click",F),t.append("text").classed("montos-item-text",!0).attr("fill","#000").text(function(t){return r[t]})})),t||g.montosGroup.selectAll("g.montos-item").style("display","block"),g.montosGroup.selectAll("rect.montos-item-frame").transition().duration(700).attr("x",g.margin).attr("y",g.margin).attr("height",a-2*g.margin).attr("width",n-2*g.margin),g.montosGroup.selectAll("text.montos-item-text").transition().duration(700).attr("x",15).attr("y",25),b(g.montosGroup.selectAll("g.montos-item").transition().duration(1e3).style("opacity",1),n,a)}function D(t){l.clusters={},l.clusterPoints={};var r=!!t&&t.replace("montos-item-",""),e=c.obras.filter(function(t){return t.monto_contrato&&""!=t.monto_contrato&&(!r||r&&t.monto_slug===r)}),a=Math.ceil(p.max(e,function(t){return t[c.selectedRadioDimension]})),n=Math.floor(p.min(e,function(t){return t[c.selectedRadioDimension]}));l.scale=p.scale.linear().domain([parseInt(n),parseInt(a)]).range([10,r?100:50]),l.nodes=e.map(function(t){var e="m-"+t.monto_slug,a=r?10:5,n={cluster:e,radius:a||10,data:t};return(!l.clusters[e]||a>l.clusters[e].radius)&&(l.clusters[e]=n),n}),r?l.clusterPoints=!1:p.selectAll("g.montos-item").each(function(t){var e=p.select(this),a=e.select("rect");l.clusterPoints["m-"+t]={x:p.transform(e.attr("transform")).translate[0]+a.attr("width")/2,y:p.transform(e.attr("transform")).translate[1]+a.attr("height")/2,radius:10}})}var E=p.select(null);function S(t){E.classed("active",!1),E=p.select(null),p.selectAll("g.montos-item").style("display","block"),O(t),t||setTimeout(function(){D(),L()},2e3)}function F(t){if(!c.isSmallDevice){if(c.closeTooltip(),E.node()===this)return S();E.classed("active",!1);var e=(E=p.select(this).classed("active",!0)).node().parentNode;p.selectAll("g.montos-item").transition().style("opacity",function(){return this===e?1:0}).each("end",function(){this!==e&&p.select(this).style("display","none")}),E.transition().duration(750).attr("height",g.h-2*g.margin).attr("width",g.w-2*g.margin),p.select(e).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){D(p.select(e).attr("id")),L()})}}function R(t){var a,n,e=["en-proyecto","en-licitacion","en-ejecucion","finalizada"],r={"en-proyecto":"En Proyecto","en-licitacion":"En Licitación","en-ejecucion":"En Ejecución",finalizada:"Finalizada"};c.isSmallDevice?(a=g.w,n=g.w,g.svg.attr("height",e.length*g.w),g.mainGroup.select("rect").attr("height",e.length*g.w)):(a=g.h/2,n=g.w/2),g.etapasGroup||(g.etapasGroup=g.svg.select("#etapas-group"),g.etapasGroup.selectAll("g.etapas-item").data(e).enter().append("g").classed("child",!0).classed("etapas-item",!0).style("opacity",0).attr("transform",function(t,e){return"translate("+(g.w/2-n/2)+","+(g.h/2-a/2)+")"}).attr("id",function(t){return"etapas-item-"+t}).each(function(){var t=p.select(this);t.append("rect").classed("etapas-item-frame",!0).on("click",P),t.append("text").classed("etapas-item-text",!0).attr("fill","#000").text(function(t){return r[t]})})),t||g.etapasGroup.selectAll("g.etapas-item").style("display","block"),g.etapasGroup.selectAll("rect.etapas-item-frame").transition().duration(700).attr("x",g.margin).attr("y",g.margin).attr("height",a-2*g.margin).attr("width",n-2*g.margin),g.etapasGroup.selectAll("text.etapas-item-text").transition().duration(700).attr("x",15).attr("y",25),b(g.etapasGroup.selectAll("g.etapas-item").transition().duration(1e3).style("opacity",1),n,a)}function I(t){l.clusters={},l.clusterPoints={},l.nodesEtapas=[];var r=!!t&&t.replace("etapas-item-",""),e=c.obras.filter(function(t){return t.etapa&&""!=t.etapa&&(!r||r&&t.etapa_slug===r)}),a=Math.ceil(p.max(e,function(t){return t[c.selectedRadioDimension]})),n=Math.floor(p.min(e,function(t){return t[c.selectedRadioDimension]}));l.scale=p.scale.linear().domain([parseInt(n),parseInt(a)]).range([10,r?100:50]),l.nodes=e.map(function(t){var e="e-"+t.etapa_slug,a=r?10:5,n={cluster:e,radius:a||10,data:t};return(!l.clusters[e]||a>l.clusters[e].radius)&&(l.clusters[e]=n),n}),r?l.clusterPoints=!1:p.selectAll("g.etapas-item").each(function(t){var e=p.select(this),a=e.select("rect");l.clusterPoints["e-"+t]={x:p.transform(e.attr("transform")).translate[0]+a.attr("width")/2,y:p.transform(e.attr("transform")).translate[1]+a.attr("height")/2,radius:10}})}var j=p.select(null);function G(t){j.classed("active",!1),j=p.select(null),p.selectAll("g.etapas-item").style("display","block"),R(t),t||setTimeout(function(){I(),L()},2e3)}function P(t){if(!c.isSmallDevice){if(c.closeTooltip(),j.node()===this)return G();j.classed("active",!1);var e=(j=p.select(this).classed("active",!0)).node().parentNode;p.selectAll("g.etapas-item").transition().style("opacity",function(){return this===e?1:0}).each("end",function(){this!==e&&p.select(this).style("display","none")}),j.transition().duration(750).attr("height",g.h-2*g.margin).attr("width",g.w-2*g.margin),p.select(e).transition().duration(750).attr("transform","translate(0,0)").each("end",function(){I(p.select(e).attr("id")),L()})}}function M(t,e,a){a.node().innerHTML="<div class='circle-bg'></div>",a.node().appendChild(e);var n=c.tipo_colors(t);a.select("svg").attr("width").replace("px","");var r=a.select("svg").attr("height",50).attr("width",50);a.select(".circle-bg").style("background-color",n),r.selectAll("path,rect").attr("fill","#fff")}function L(){"mapa"!=c.selectedGroup&&l.icons.transition().duration(500).attr("opacity",0),l.force=p.layout.force().nodes(l.nodes).size([g.w,g.h]).gravity(0).charge(function(){return c.isSmallDevice?0:1}).on("tick",B).start().on("end",function(){c.loadedBanderita?"mapa"==c.selectedGroup&&l.icons.attr("opacity",1):(l.circles.filter(function(t){return t.data.destacada}).each(function(a){var t=a.x-9,e=a.y-25;l.icons.append("g").attr("class",function(t){var e=a.data.red_slug?"red "+a.data.red_slug:"";return"banderita  "+(a.data.destacada?"destacada ":"")+" "+a.data.tipo_slug+" "+a.data.area_slug+" "+a.data.etapa_slug+" "+e+" "+a.data.nombre.toLowerCase()}).attr("transform","translate("+t+","+e+") scale(0.25)")}),p.selectAll("g.banderita").append(function(){return a.cloneNode(!0).documentElement}),c.loadedBanderita=!0)}),l.circles=l.group.selectAll("circle.obra").data(l.nodes),c.isSmallDevice||l.circles.enter().append("circle").attr("class",function(t){var e=t.data.red_slug?"red "+t.data.red_slug:"";return"obra  "+(t.data.destacada?" destacada ":"")+" "+t.data.tipo_slug+" "+t.data.area_slug+" "+t.data.etapa_slug+" "+e+" "+t.data.nombre.toLowerCase()}).on("mouseenter",function(a){if("1"==p.select(this).style("opacity")){a.color_tipo_obra=c.tipo_colors(a.data.tipo),c.selectedObra=a,c.tooltipThumb=a.data.thumb,c.$apply();var n=p.select("#tooltip-logo-container");if(!c.selectedObra.map&&window.MDUYT_CONFIG.USE_USIG_MAP_TILES){var t=u.getTrustedResourceUrl("https://ws.usig.buenosaires.gob.ar/geocoder/2.2/reversegeocoding?x="+a.data.lng+"&y="+a.data.lat);d.jsonp(t,{jsonpCallbackParam:"callback"}).then(function(t){c.selectedObra.map="http://servicios.usig.buenosaires.gov.ar/LocDir/mapa.phtml?x="+t.data.puerta_x+"&y="+t.data.puerta_y+"&h=100&w=300&punto=1&r=50"})}c.showObraImg=c.selectedObra.map||window.MDUYT_CONFIG.USE_USIG_MAP_TILES,m[a.data.tipo_slug]?M(a.data.tipo,m[a.data.tipo_slug],n):p.xml("images/iconos/"+a.data.tipo_slug+".svg",function(t,e){t?console.error(t):(m[a.data.tipo_slug]=e.getElementsByTagName("svg")[0],M(a.data.tipo,m[a.data.tipo_slug],n))});var e=p.select(this);g.selection.attr("cx",e.attr("cx")).attr("cy",e.attr("cy")).attr("r",0).style("stroke",a.color_tipo_obra).transition().duration(500).attr("r",13).style("opacity",1);var r=g.w/2<p.event.pageX?p.event.pageX-320:p.event.pageX,i=parseInt(c.tooltip.style("height").replace("px","")),o=document.body,s=document.documentElement,l=Math.max(o.scrollHeight,o.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight)-600<p.event.pageY?p.event.pageY-i:p.event.pageY;c.tooltip.style("width","300px").transition().duration(200).style("top",l+"px").style("left",r+"px").style("opacity",1)}}).on("mouseout",function(t){}),c.isSmallDevice&&l.circles.enter().append("circle").attr("class",function(t){var e=t.data.red_slug?"red "+t.data.red_slug:"";return"obra "+(t.data.destacada?"destacada ":"")+" "+t.data.tipo_slug+" "+t.data.area_slug+" "+t.data.etapa_slug+" "+e+" "+t.data.nombre.toLowerCase()}).on("click",function(a){if(a.color_tipo_obra=c.tipo_colors(a.data.tipo),c.selectedObra=a,c.tooltipThumb=!1,!c.selectedObra.map){var t=u.getTrustedResourceUrl("https://ws.usig.buenosaires.gob.ar/geocoder/2.2/reversegeocoding?x="+a.data.lng+"&y="+a.data.lat);d.jsonp(t,{jsonpCallbackParam:"callback"}).then(function(t){c.selectedObra.map="http://servicios.usig.buenosaires.gov.ar/LocDir/mapa.phtml?x="+t.data.puerta_x+"&y="+t.data.puerta_y+"&h=100&w=300&punto=1&r=50"})}var n=p.select("#tooltip-logo-container");m[a.data.tipo_slug]?M(a.data.tipo,m[a.data.tipo_slug],n):p.xml("images/iconos/"+a.data.tipo_slug+".svg",function(t,e){t?console.error(t):(m[a.data.tipo_slug]=e.getElementsByTagName("svg")[0],M(a.data.tipo,m[a.data.tipo_slug],n))}),p.selectAll("circle.obra").style("opacity",.3),p.select(this).style("opacity",1),c.tooltip.style("width",g.w-20+"px").transition().duration(200).style("left","10px").style("top",p.event.pageY+"px").style("opacity",1),c.$apply()}),l.circles.attr("id",function(t){return"e"+t.data.id}).attr("class",function(t){var e=t.data.red_slug?"red "+t.data.red_slug:"";return"obra "+(t.data.destacada?"destacada ":"")+" "+t.data.tipo_slug+" "+t.data.area_slug+" "+t.data.etapa_slug+" "+e+" "+t.data.nombre.toLowerCase()}).style("fill",function(t){return c.tipo_colors(t.data.tipo)}),l.circles.transition().style("opacity",1).attr("r",function(t){return t.radius}),l.circles.exit().remove(),c.filterBubbles(c.selectedFilter)}function B(t){var m,e,s;l.circles.each((s=10*t.alpha*t.alpha,function(t){var e=l.clusters[t.cluster],a=1;if(e){e===t&&(a=l.clusterPoints?(e={x:(e=l.clusterPoints[t.cluster]).x,y:e.y,radius:-e.radius},5*Math.sqrt(t.radius)):(e={x:g.w/2,y:g.h/2,radius:-t.radius},Math.sqrt(t.radius)));var n=t.x-e.x,r=t.y-e.y,i=Math.sqrt(n*n+r*r),o=t.radius+e.radius;i!==o&&(i=(i-o)/i*s*a,t.x-=n*=i,t.y-=r*=i,e.x+=n,e.y+=r)}})).each((m=.2,e=p.geom.quadtree(l.nodes),function(c){var t=c.radius+2,d=c.x-t,u=c.x+t,p=c.y-t,g=c.y+t;e.visit(function(t,e,a,n,r){if(t.point&&t.point!==c){var i=c.x-t.point.x,o=c.y-t.point.y,s=Math.sqrt(i*i+o*o),l=c.radius+t.point.radius+2;s<l&&(s=(s-l)/s*m,c.x-=i*=s,c.y-=o*=s,t.point.x+=i,t.point.y+=o)}return u<e||n<d||g<a||r<p})})).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})}c.loadedBanderita=!1,c.closeTooltip=function(){g.selection.transition().duration(200).attr("r",0).style("opacity",0),c.tooltip.transition().duration(200).style("top","-500px").style("opacity",0)},c.closeList=function(){c.showList=!1,c.filteredObras=[],c.selectedComuna=""}}]),angular.module("obrasMduytApp").controller("ObraCtrl",["$scope","DataService","$routeParams",function(e,t,a){var n;e.i18n=window._i18n,e.loading=!0,e.pymChild=new window.pym.Child({polling:1e3}),e.pymChild.sendHeight(),e.obraId=a.id,e.tipo_colors=function(t){var e=[];return e["Espacio Público"]="#A7C64D",e.Escuelas="#7874B2",e.Salud="#F1AD3C",e.Arquitectura="#38A0D7",e["Hidráulica e Infraestructura"]="#BD3E93",e.Transporte="#E84D00",e.Vivienda="#22B496",e[t]},n=window.MDUYT_CONFIG.USE_USIG_MAP_TILES?{url:"//tiles1.usig.buenosaires.gob.ar/mapcache/tms/1.0.0/amba_con_transporte_3857@GoogleMapsCompatible/{z}/{x}/{y}.png",format:"tms",builder:"tms",baseLayer:!0,options:{maxZoom:18,minZoom:9,attribution:'USIG (<a href="http://www.buenosaires.gob.ar" target="_blank">GCBA</a>), © <a href="http://www.openstreetmap.org/copyright/en" target="_blank">OpenStreetMap</a> (ODbL)',tms:!0}}:{url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",baseLayer:!0},e.titles=n,angular.extend(e,{markers:{},center:{lat:-34.604,lng:-58.382,zoom:15},tiles:n,defaults:{scrollWheelZoom:!1}}),e.mainCallback=function(t){e.drawLineOnObraLoaded=t},e.drawFirstColored=function(t){e.firstColoredLoaded=t},e.drawSecondColored=function(t){e.secondColoredLoaded=t},t.getById(a.id).then(function(t){!(e.obra=t).hideDates&&e.drawLineOnObraLoaded&&e.drawLineOnObraLoaded(t),t.beneficiarios&&e.firstColoredLoaded&&e.firstColoredLoaded(t),t.mano_obra&&e.secondColoredLoaded&&e.secondColoredLoaded(t),e.slides=t.fotos.map(function(t){return{mode:t.includes("youtu")?"video":"photo",url:t,pic:t.includes("youtu")?getYoutubePic(t):t}}),angular.extend(e,{center:{lat:parseFloat(t.lat),lng:parseFloat(t.lng),zoom:15},markers:{m1:{lat:parseFloat(t.lat),lng:parseFloat(t.lng),focus:!0,message:t.nombre}}}),e.center.lat=parseFloat(t.lat),e.center.lng=parseFloat(t.lng);t.fecha_inicio,t.fecha_fin_inicial;e.loading=!1})}]),angular.module("obrasMduytApp").controller("EntornoCtrl",["$scope","DataService","$routeParams","leafletData","$timeout",function(s,t,l,c,d){var e;s.i18n=window._i18n,s.loading=!0,s.pymChild=new window.pym.Child({polling:1e3}),s.pymChild.sendHeight(),e=window.MDUYT_CONFIG.USE_USIG_MAP_TILES?{url:"//tiles1.usig.buenosaires.gob.ar/mapcache/tms/1.0.0/amba_con_transporte_3857@GoogleMapsCompatible/{z}/{x}/{y}.png",format:"tms",builder:"tms",baseLayer:!0,options:{maxZoom:18,minZoom:9,attribution:'USIG (<a href="http://www.buenosaires.gob.ar" target="_blank">GCBA</a>), © <a href="http://www.openstreetmap.org/copyright/en" target="_blank">OpenStreetMap</a> (ODbL)',tms:!0}}:{url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",baseLayer:!0},s.titles=e,angular.extend(s,{markers:{},center:{lat:-34.604,lng:-58.382,zoom:15},tiles:e,defaults:{scrollWheelZoom:!1}}),t.getByEntorno(l.entorno).then(function(t){s.entorno=l.entorno,s.obras=t;for(var e={},a=[],n=0;n<t.length;n++){var r=t[n];if(r.lat&&r.lng){var i={lat:parseFloat(r.lat),lng:parseFloat(r.lng),focus:!0,message:r.nombre};e["m"+n]=i,a.push(L.marker([i.lat,i.lng]))}}var o=new L.featureGroup(a);angular.extend(s,{markers:e}),s.loading=!1,d(function(){c.getMap().then(function(t){t.fitBounds(o.getBounds(),{padding:[50,50]})})},1e3)})}]),angular.module("obrasMduytApp").controller("BuscadorCtrl",["$scope","DataService","$routeParams","NgTableParams","$filter","$sce","ngTableEventsChannel",function(r,t,e,i,a,o,s){r.i18n=window._i18n,r.loading=!0,r.pymChild=new window.pym.Child({polling:1e3}),r.pymChild.sendHeight(),r.montos_string={monto_0_50:r.i18n.upTo50Millions,monto_50_100:r.i18n.from50To100Millions,monto_100_150:r.i18n.from100To150Millions,monto_mas_50:r.i18n.moreThan150Millions},t.getAll().then(function(t){var e={comunas:d3.keys(d3.nest().key(function(t){return t.comuna}).map(t.filter(function(t){return null!==t.comuna}))).map(function(t){return{id:t.trim(),title:"Comuna "+t}}),etapas:d3.keys(d3.nest().key(function(t){return t.etapa}).map(t)).map(function(t){return{id:t,title:t}}),tipos:d3.keys(d3.nest().key(function(t){return t.tipo}).map(t)).map(function(t){return{id:t,title:t}}),montos:d3.keys(d3.nest().key(function(t){return t.monto_slug}).map(t.filter(function(t){return t.monto_slug}))).map(function(t){return{id:t,title:r.montos_string[t]}}),areas:d3.keys(d3.nest().key(function(t){return t.area_responsable}).map(t.filter(function(t){return t.area_responsable}))).map(function(t){return{id:t,title:t}})};function a(t,e){return e[this.field]}e.comunas.unshift({id:"",title:r.i18n.all}),e.etapas.unshift({id:"",title:r.i18n.all}),e.areas.unshift({id:"",title:r.i18n.all}),e.tipos.unshift({id:"",title:r.i18n.all}),e.montos.unshift({id:"",title:r.i18n.all}),r.cols=[];var n=function(e){return _.some(t,function(t){return t[e]})};n("comuna")&&r.cols.push({field:"comuna",title:"Comuna",filter:{comuna:"select"},filterData:e.comunas,show:!0,getValue:a}),r.cols.push({field:"nombre",title:"Nombre",filter:{nombre:"text"},show:!0,class:"lupita",getValue:a}),n("area_responsable")&&r.cols.push({field:"area_responsable",title:"Área Responsable",filter:{area_responsable:"select"},filterData:e.areas,show:!0,getValue:a}),n("etapa")&&r.cols.push({field:"etapa",title:"Etapa",filter:{etapa:"select"},filterData:e.etapas,show:!0,getValue:a}),n("tipo")&&r.cols.push({field:"tipo",title:"Tipo",filter:{tipo:"select"},filterData:e.tipos,show:!0,getValue:a}),n("monto_slug")&&r.cols.push({field:"monto_slug",title:"Monto Inversión",filter:{monto_slug:"select"},filterData:e.montos,show:!0,getValue:a}),n("link_interno")&&r.cols.push({field:"link_interno",title:"",filter:!1,show:!0,getValue:function(t,e){var a=e[this.field],n="";return a&&""!=a&&(n="<a href='"+a+"' class='btn btn-default btn-xs btn-block' target='_blank'>Más información</a>"),o.trustAsHtml(n)}}),n("licitacion_oferta_empresa")&&r.cols.push({field:"licitacion_oferta_empresa",title:"Empresa",filter:{licitacion_oferta_empresa:"text"},show:!0,class:"lupita",getValue:a}),s.onAfterCreated(function(){$('[ng-table-pagination="params"]').appendTo("#footer")},r),s.onAfterReloadData(function(t){r.results=t.data},r),r.tableParams=new i({sorting:{comuna:"asc"},filter:{comuna:"",etapa:"",tipo:"",monto_slug:"",area_responsable:""},page:1,count:10},{dataset:t,counts:[10,25,50]});r.loading=!1,r.timeoutId,window.$(window).resize(function(){clearTimeout(r.timeoutId),r.timeoutId=setTimeout(function(){},1e3)})})}]),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("angular")):"function"==typeof define&&define.amd?define(["angular"],e):"object"==typeof exports?exports["ng-table"]=e(require("angular")):t["ng-table"]=e(t.angular)}(this,function(a){return function(a){function n(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return a[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var r={};return n.m=a,n.c=r,n.i=function(t){return t},n.d=function(t,e,a){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=33)}(function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(typeof e[t]){case"function":break;case"object":e[t]=function(t){var n=t.slice(1),r=e[t[0]];return function(t,e,a){r.apply(this,[t,e,a].concat(n))}}(e[t]);break;default:e[t]=e[e[t]]}return e}([function(t,e){t.exports=a},function(t,a,e){"use strict";var n=e(0),r=e(4),i=e(5),o=e(6),s=e(7),l=e(8),c=e(9),d=e(10),u=e(11),p=e(12),g=e(13),m=e(14),f=e(15),h=e(16),v=e(17);e(25),e(27),e(26),e(28),e(31),e(30),Object.defineProperty(a,"__esModule",{value:!0}),a.default=n.module("ngTable-browser",[]).directive("ngTable",r.ngTable).factory("ngTableColumn",i.ngTableColumn).directive("ngTableColumnsBinding",o.ngTableColumnsBinding).controller("ngTableController",s.ngTableController).directive("ngTableDynamic",l.ngTableDynamic).provider("ngTableFilterConfig",c.ngTableFilterConfigProvider).directive("ngTableFilterRow",d.ngTableFilterRow).controller("ngTableFilterRowController",u.ngTableFilterRowController).directive("ngTableGroupRow",p.ngTableGroupRow).controller("ngTableGroupRowController",g.ngTableGroupRowController).directive("ngTablePagination",m.ngTablePagination).directive("ngTableSelectFilterDs",f.ngTableSelectFilterDs).directive("ngTableSorterRow",h.ngTableSorterRow).controller("ngTableSorterRowController",v.ngTableSorterRowController),function(t){for(var e in t)a.hasOwnProperty(e)||(a[e]=t[e])}(e(18))},function(t,a,e){"use strict";var n=e(0),r=e(19),i=e(20),o=e(22),s=e(21);Object.defineProperty(a,"__esModule",{value:!0}),a.default=n.module("ngTable-core",[]).provider("ngTableDefaultGetData",r.ngTableDefaultGetDataProvider).value("ngTableDefaults",i.ngTableDefaults).factory("NgTableParams",o.ngTableParamsFactory).factory("ngTableEventsChannel",s.ngTableEventsChannel),function(t){for(var e in t)a.hasOwnProperty(e)||(a[e]=t[e])}(e(23))},,function(t,e,a){"use strict";function n(t,d){return{restrict:"A",priority:1001,scope:!0,controller:"ngTableController",compile:function(t){var e,s,l=[],c=0,a=[];if(u.forEach(t.find("tr"),function(t){a.push(u.element(t))}),e=a.filter(function(t){return!t.hasClass("ng-table-group")})[0],s=a.filter(function(t){return t.hasClass("ng-table-group")})[0],e)return u.forEach(e.find("td"),function(t){var e,a,n=u.element(t);if(!n.attr("ignore-cell")||"true"!==n.attr("ignore-cell")){var i=function(t){return n.attr("x-data-"+t)||n.attr("data-"+t)||n.attr(t)},r=function(t){var n=i(t);if(n){var r,e=function(t){return void 0!==r?r:d(n)(t)};return e.assign=function(t,e){var a=d(n);a.assign?a.assign(t.$parent,e):r=e},e}},o=i("title-alt")||i("title");o&&n.attr("data-title-text","{{"+o+"}}"),l.push({id:c++,title:r("title"),titleAlt:r("title-alt"),headerTitle:r("header-title"),sortable:r("sortable"),class:r("header-class"),filter:r("filter"),groupable:r("groupable"),headerTemplateURL:r("header"),filterData:r("filter-data"),show:n.attr("ng-if")?r("ng-if"):void 0}),(s||n.attr("ng-if"))&&(e="ng-if",a="$columns["+(l.length-1)+"].show(this)",n.attr("x-data-"+e)?n.attr("x-data-"+e,a):n.attr("data"+e)?n.attr("data"+e,a):n.attr(e,a))}}),function(t,e,a,n){t.$columns=l=n.buildColumns(l),n.setupBindingsToInternalScope(a.ngTable),n.loadFilterData(l),n.compileDirectiveTemplates()}}}}var u=a(0);n.$inject=["$q","$parse"],e.ngTable=n},function(t,e,a){"use strict";function n(){function a(t){var a=t,e=function t(){return 1!==arguments.length||s(arguments[0])?a:void t.assign(null,arguments[0])};return e.assign=function(t,e){a=e},e}function s(t){return null!=t&&l.isFunction(t.$new)}return{buildColumn:function(n,r,i){var o=Object.create(n),t={class:a(""),filter:a(!1),groupable:a(!1),filterData:l.noop,headerTemplateURL:a(!1),headerTitle:a(""),sortable:a(!1),show:a(!0),title:a(""),titleAlt:a("")};for(var e in t)void 0===o[e]&&(o[e]=t[e]),l.isFunction(o[e])||function(a){var t=function t(){return 1!==arguments.length||s(arguments[0])?n[a]:void t.assign(null,arguments[0])};t.assign=function(t,e){n[a]=e},o[a]=t}(e),function(t){var a=o[t];o[t]=function(){if(1!==arguments.length||s(arguments[0])){var t=arguments[0]||r,e=Object.create(t);return l.extend(e,{$column:o,$columns:i}),a.call(n,e)}a.assign(null,arguments[0])},a.assign&&(o[t].assign=a.assign)}(e);return o}}}var l=a(0);n.$inject=[],e.ngTableColumn=n},function(t,e){"use strict";function a(r){return{restrict:"A",require:"ngTable",link:function(a,t,e){var n=r(e.ngTableColumnsBinding).assign;n&&a.$watch("$columns",function(t){var e=(t||[]).slice(0);n(a,e)})}}}a.$inject=["$parse"],e.ngTableColumnsBinding=a},function(t,e,a){"use strict";function n(r,t,a,n,i,o,s,l,c,e){function d(){return!!r.$columns&&function(t,e){for(var a=!1,n=0;n<t.length;n++){var r=t[n];if(e(r)){a=!0;break}}return a}(r.$columns,function(t){return t.show(r)&&!!t.filter(r)})}r.$filterRow={disabled:!1},r.$loading=!1,r.hasOwnProperty("params")||(r.params=new t(!0));var u,p=function(t,e){a.cancel(u),u=a(t,e)};r.$watch("params",function(t,e){t!==e&&t&&t.reload()},!1),r.$watch("params.isDataReloadRequired()",function(t){if(t&&!r.params.hasErrorState()){var e=r.params,a=e.settings().filterOptions;if(e.hasFilterChanges()){var n=function(){e.page(1),e.reload()};a.filterDelay?p(n,a.filterDelay):n()}else e.reload()}}),this.compileDirectiveTemplates=function(){if(!s.hasClass("ng-table")){r.templates={header:o.templateHeader?o.templateHeader:"ng-table/header.html",pagination:o.templatePagination?o.templatePagination:"ng-table/pager.html"},s.addClass("ng-table");var t=null,e=!1;g.forEach(s.children(),function(t){"THEAD"===t.tagName&&(e=!0)}),e||(t=g.element('<thead ng-include="templates.header"></thead>',l),s.prepend(t));var a=g.element('<div ng-table-pagination="params" template-url="templates.pagination"></div>',l);s.after(a),t&&i(t)(r),i(a)(r)}},this.loadFilterData=function(t){g.forEach(t,function(e){var t,a=e.filterData(r);return a?(t=a)&&"object"==typeof t&&"function"==typeof t.then?(delete e.filterData,a.then(function(t){g.isArray(t)||g.isFunction(t)||g.isObject(t)||(t=[]),e.data=t})):e.data=a:void delete e.filterData})},this.buildColumns=function(t){var e=[];return(t||[]).forEach(function(t){e.push(c.buildColumn(t,r,e))}),e},this.parseNgTableDynamicExpr=function(t){if(!t||-1<t.indexOf(" with ")){var e=t.split(/\s+with\s+/);return{tableParams:e[0],columns:e[1]}}throw new Error("Parse error (expected example: ng-table-dynamic='tableParams with cols')")},this.setupBindingsToInternalScope=function(t){r.$watch(t,function(t){void 0!==t&&(r.params=t)},!1),o.showFilter?r.$parent.$watch(o.showFilter,function(t){r.show_filter=t}):r.$watch(d,function(t){r.show_filter=t}),o.disableFilter&&r.$parent.$watch(o.disableFilter,function(t){r.$filterRow.disabled=t}),function(){if(r.$groupRow={show:!1},o.showGroup){var e=n(o.showGroup);r.$parent.$watch(e,function(t){r.$groupRow.show=t}),e.assign&&r.$watch("$groupRow.show",function(t){e.assign(r.$parent,t)})}else r.$watch("params.hasGroup()",function(t){r.$groupRow.show=t})}()},e.onAfterReloadData(function(t,e){var a=(r.$columns||[]).filter(function(t){return t.show(r)});t.hasGroup()?(r.$groups=e||[],r.$groups.visibleColumnCount=a.length):(r.$data=e||[],r.$data.visibleColumnCount=a.length)},r,function(t){return r.params===t}),e.onPagesChanged(function(t,e){r.pages=e},r,function(t){return r.params===t})}var g=a(0);n.$inject=["$scope","NgTableParams","$timeout","$parse","$compile","$attrs","$element","$document","ngTableColumn","ngTableEventsChannel"],e.ngTableController=n},function(t,e,a){"use strict";function n(){return{restrict:"A",priority:1001,scope:!0,controller:"ngTableController",compile:function(t){var e;if(r.forEach(t.find("tr"),function(t){(t=r.element(t)).hasClass("ng-table-group")||e||(e=t)}),e)return r.forEach(e.find("td"),function(t){var e,a=r.element(t);(e="title",a.attr("x-data-"+e)||a.attr("data-"+e)||a.attr(e))||a.attr("data-title-text","{{$columns[$index].titleAlt(this) || $columns[$index].title(this)}}"),a.attr("ng-if")||a.attr("ng-if","$columns[$index].show(this)")}),function(e,t,a,n){var r=n.parseNgTableDynamicExpr(a.ngTableDynamic);n.setupBindingsToInternalScope(r.tableParams),n.compileDirectiveTemplates(),e.$watchCollection(r.columns,function(t){e.$columns=n.buildColumns(t),n.loadFilterData(e.$columns)})}}}}var r=a(0);n.$inject=[],e.ngTableDynamic=n},function(t,e,a){"use strict";function n(){function t(){a=n}function e(){var t,n={config:t,getTemplateUrl:function(t,e){var a;return-1!==(a="string"!=typeof t?t.id:t).indexOf("/")?a:n.getUrlForAlias(a,e)},getUrlForAlias:function(t,e){return a.aliasUrls[t]||a.defaultBaseUrl+t+a.defaultExt}};return Object.defineProperty(n,"config",{get:function(){return t=t||r.copy(a)},enumerable:!0}),n}var a,n={defaultBaseUrl:"ng-table/filters/",defaultExt:".html",aliasUrls:{}};this.$get=e,this.resetConfigs=t,this.setConfig=function(t){var e=r.extend({},a,t);e.aliasUrls=r.extend({},a.aliasUrls,t.aliasUrls),a=e},t(),e.$inject=[]}var r=a(0);n.$inject=[],e.ngTableFilterConfigProvider=n},function(t,e,a){"use strict";function n(){return{restrict:"E",replace:!0,templateUrl:r,scope:!0,controller:"ngTableFilterRowController"}}var r=a(24);n.$inject=[],e.ngTableFilterRow=n},function(t,e){"use strict";function a(t,e){t.config=e,t.getFilterCellCss=function(t,e){if("horizontal"!==e)return"s12";var a=Object.keys(t).length;return"s"+parseInt((12/a).toString(),10)},t.getFilterPlaceholderValue=function(t,e){return"string"==typeof t?"":t.placeholder}}a.$inject=["$scope","ngTableFilterConfig"],e.ngTableFilterRowController=a},function(t,e,a){"use strict";function n(){return{restrict:"E",replace:!0,templateUrl:r,scope:!0,controller:"ngTableGroupRowController",controllerAs:"dctrl"}}var r=a(29);n.$inject=[],e.ngTableGroupRow=n},function(t,e){"use strict";function a(r){function i(e){return r.$columns.filter(function(t){return t.groupable(r)===e})[0]}function t(t){return o(t)?t.title:t.title(r)}function e(){var t=r.$columns.filter(function(t){return!!t.groupable(r)});return d.concat(t)}function a(){return r.$columns.filter(function(t){return t.show(r)})}function n(t){var e;s(t)?(e=r.params.hasGroup(r.$selGroup,"asc")?"desc":r.params.hasGroup(r.$selGroup,"desc")?"":"asc",r.params.group(r.$selGroup,e)):o(t)?r.params.group(t):r.params.group(t.groupable(r))}function o(t){return"function"==typeof t}function s(t){return o(t)?t===r.$selGroup:t.groupable(r)===r.$selGroup}function l(t){var e=i(r.$selGroup);if(e&&e.show.assign&&e.show.assign(r,!0),o(t))d=[t],r.$selGroup=t,r.$selGroupTitle=t.title;else{var a=Object.keys(t||{})[0],n=i(a);n&&(r.$selGroupTitle=n.title(r),r.$selGroup=a,n.show.assign&&n.show.assign(r,!1))}}function c(){return r.params.settings().groupOptions.isExpanded=!r.params.settings().groupOptions.isExpanded,r.params.reload()}var d=[];r.getGroupables=e,r.getGroupTitle=t,r.getVisibleColumns=a,r.groupBy=n,r.isSelectedGroup=s,r.toggleDetail=c,r.$watch("params.group()",l,!0)}a.$inject=["$scope"],e.ngTableGroupRowController=a},function(t,e,a){"use strict";function n(r,i,t){return{restrict:"A",scope:{params:"=ngTablePagination",templateUrl:"="},replace:!1,link:function(a,n){t.onAfterReloadData(function(t){a.pages=t.generatePagesArray()},a,function(t){return t===a.params}),a.$watch("templateUrl",function(t){if(void 0!==t){var e=o.element('<div ng-include="templateUrl"></div>',i);n.append(e),r(e)(a)}})}}}var o=a(0);n.$inject=["$compile","$document","ngTableEventsChannel"],e.ngTablePagination=n},function(t,e){"use strict";function a(){return{restrict:"A",controller:n}}function n(a,t,e,n){function r(){var t,e;(t=i,e=t.data,e instanceof Array?n.when(e):n.when(e&&e())).then(function(t){t&&!function(t){for(var e,a=0;a<t.length;a++){var n=t[a];if(n&&""===n.id){e=!0;break}}return e}(t)&&t.unshift({id:"",title:""}),t=t||[],a.$selectData=t})}var i;i=t(e.ngTableSelectFilterDs)(a),a.$watch(function(){return i&&i.data},r)}a.$inject=[],e.ngTableSelectFilterDs=a,n.$inject=["$scope","$parse","$attrs","$q"]},function(t,e,a){"use strict";function n(){return{restrict:"E",replace:!0,templateUrl:r,scope:!0,controller:"ngTableSorterRowController"}}var r=a(32);n.$inject=[],e.ngTableSorterRow=n},function(t,e){"use strict";function a(s){s.sortBy=function(t,e){var a=t.sortable&&t.sortable();if(a&&"string"==typeof a){var n=s.params.settings().defaultSort,r="asc"===n?"desc":"asc",i=s.params.sorting()&&s.params.sorting()[a]&&s.params.sorting()[a]===n,o=e.ctrlKey||e.metaKey?s.params.sorting():{};o[a]=i?r:n,s.params.parameters({sorting:o})}}}a.$inject=["$scope"],e.ngTableSorterRowController=a},function(t,e){},function(t,e,a){"use strict";var p=a(0),n=function(){function t(a){function c(t){var e=t.settings().filterOptions;return p.isFunction(e.filterFn)?e.filterFn:a(e.filterFilterName||n.filterFilterName)}function l(t){return a(n.sortingFilterName)}function d(t,e){var a=t.slice((e.page()-1)*e.count(),e.page()*e.count());return e.total(t.length),a}function t(t,e){if(null==t)return[];var a,n,r,i=p.extend({},u,e.settings().dataOptions),o=i.applyFilter?function(t,e){if(!e.hasFilter())return t;var l=e.filter(!0),a=Object.keys(l).reduce(function(t,e){return a=t,n=l[e],r=e.split("."),i=a,o=r[r.length-1],s=i,r.slice(0,r.length-1).forEach(function(t){s.hasOwnProperty(t)||(s[t]={}),s=s[t]}),s[o]=n,i;var a,n,r,i,o,s},{});return c(e).call(e,t,a,e.settings().filterOptions.filterComparator)}(t,e):t,s=i.applySort?(a=o,n=e.orderBy(),r=l(),n.length?r(a,n):a):o;return i.applyPaging?d(s,e):s}var u={applyFilter:!0,applySort:!0,applyPaging:!0};return t.applyPaging=d,t.getFilterFn=c,t.getOrderByFn=l,t}this.filterFilterName="filter",this.sortingFilterName="orderBy";var n=this;(this.$get=t).$inject=["$filter"]};e.ngTableDefaultGetDataProvider=n},function(t,e){"use strict";e.ngTableDefaults={params:{},settings:{}}},function(t,e,a){"use strict";function n(l){function t(t,e){var a,n,r=t.charAt(0).toUpperCase()+t.substring(1),i=((n={})["on"+r]=function(r){function s(e){return e?"function"==typeof e?e:function(t){return t===e}:function(t){return!0}}return function(i,t,e){var o,a,n=l;return o=(a=t)&&"function"==typeof a.$new?(n=t,s(e)):s(t),n.$on("ngTable:"+r,function(t,e){for(var a=[],n=2;n<arguments.length;n++)a[n-2]=arguments[n];if(!e.isNullInstance){var r=[e].concat(a);o.apply(this,r)&&i.apply(this,r)}})}}(t),n["publish"+r]=(a=t,function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];l.$broadcast.apply(l,["ngTable:"+a].concat(t))}),n);return o.extend(e,i)}var e={};return t("pagesChanged",e=t("datasetChanged",e=t("afterReloadData",e=t("afterCreated",e))))}var o=a(0);n.$inject=["$rootScope"],e.ngTableEventsChannel=n},function(t,e,a){"use strict";function n(y,_,t,x,C,k){return function(t,e){function d(t){return!isNaN(parseFloat(t))&&isFinite(t)}function u(t){var e,a=w.groupOptions&&w.groupOptions.defaultSort;if(t){if(c(t))return null==t.sortDirection&&(t.sortDirection=a),t;if("object"!=typeof t)return(e={})[t]=a,e;for(var n in t)null==t[n]&&(t[n]=a);return t}return t}function l(t){var e=[];for(var a in t)e.push(("asc"===t[a]?"+":"-")+a);return e}function r(){var t=b.group;return{params:b,groupSortDirection:c(t)?t.sortDirection:void 0}}function c(t){return"function"==typeof t}function a(){var t=b.filter&&b.filter.$,e=o&&o.params.filter&&o.params.filter.$;return!T.equals(t,e)}function i(t){return(w.interceptors||[]).reduce(function(t,e){var a=e.response&&e.response.bind(e)||y.when,n=e.responseError&&e.responseError.bind(e)||y.reject;return t.then(function(t){return a(t,p)},function(t){return n(t,p)})},t)}"boolean"==typeof t&&(this.isNullInstance=!0);var o,s,n,p=this,g=!1,m=[],f=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];w.debugMode&&_.debug&&_.debug.apply(_,t)},h={filterComparator:void 0,filterDelay:500,filterDelayThreshold:1e4,filterFilterName:void 0,filterFn:void 0,filterLayout:"stack"},v={getData:function(t){return C(t.settings().dataset,t)},getGroups:function(r){var i,t=r.group(),o=void 0;if(c(t))o=(i=t).sortDirection;else{var e=Object.keys(t)[0];o=t[e],i=function(t){return function t(e,a){var n;if(n="string"==typeof a?a.split("."):a,void 0!==e){if(0===n.length)return e;if(null!==e)return t(e[n[0]],n.slice(1))}}(t,e)}}var s=r.settings(),a=s.dataOptions;s.dataOptions={applyPaging:!1};var n=s.getData;return y.when(n(r)).then(function(t){var a={};T.forEach(t,function(t){var e=i(t);a[e]=a[e]||{data:[],$hideRows:!s.groupOptions.isExpanded,value:e},a[e].data.push(t)});var e=[];for(var n in a)e.push(a[n]);return o&&(e=C.getOrderByFn()(e,l({value:o}))),C.applyPaging(e,r)}).finally(function(){s.dataOptions=a})}};this.data=[],this.parameters=function(t,e){if(e=e||!1,void 0===typeof t)return b;for(var a in t){var n=t[a];if(e&&0<=a.indexOf("[")){for(var r=a.split(/\[(.*)\]/).reverse(),i="",o=0,s=r.length;o<s;o++){var l=r[o];if(""!==l){var c=n;(n={})[i=l]=d(c)?parseFloat(c):c}}"sorting"===i&&(b[i]={}),b[i]=T.extend(b[i]||{},n[i])}else b[a]="group"===a?u(t[a]):d(t[a])?parseFloat(t[a]):t[a]}return f("ngTable: set parameters",b),this},this.settings=function(t){if(T.isDefined(t)){t.filterOptions&&(t.filterOptions=T.extend({},w.filterOptions,t.filterOptions)),t.groupOptions&&(t.groupOptions=T.extend({},w.groupOptions,t.groupOptions)),T.isArray(t.dataset)&&(t.total=t.dataset.length);var e=w.dataset;if(w=T.extend(w,t),T.isArray(t.dataset)&&w.filterOptions.filterDelay===h.filterDelay&&w.total<=w.filterOptions.filterDelayThreshold&&w.getData===v.getData&&(w.filterOptions.filterDelay=0),t.hasOwnProperty("dataset")&&t.dataset!=e){g&&this.page(1),g=!1;var a=function(){k.publishDatasetChanged(p,t.dataset,e)};m?m.push(a):a()}return f("ngTable: set settings",w),this}return w},this.page=function(t){return void 0!==t?this.parameters({page:t}):b.page},this.total=function(t){return void 0!==t?this.settings({total:t}):w.total},this.count=function(t){return void 0!==t?this.parameters({count:t,page:1}):b.count},this.filter=function(t){if(null!=t&&"object"==typeof t)return this.parameters({filter:t,page:1});if(!0!==t)return b.filter;for(var e=Object.keys(b.filter),a={},n=0;n<e.length;n++){var r=b.filter[e[n]];null!=r&&""!==r&&(a[e[n]]=r)}return a},this.group=function(t,e){if(void 0===t)return b.group;var a,n={page:1};return c(t)&&void 0!==e?(t.sortDirection=e,n.group=t):n.group="string"==typeof t&&void 0!==e?((a={})[t]=e,a):t,this.parameters(n),this},this.sorting=function(t,e){return"string"==typeof t&&void 0!==e?(this.parameters({sorting:(a={},a[t]=e,a)}),this):void 0!==t?this.parameters({sorting:t}):b.sorting;var a},this.isSortBy=function(t,e){return void 0!==e?void 0!==b.sorting[t]&&b.sorting[t]==e:void 0!==b.sorting[t]},this.orderBy=function(){return l(b.sorting)},this.generatePagesArray=function(t,e,a,n){var r,i,o,s;arguments.length||(t=this.page(),e=this.total(),a=this.count()),n=n&&n<6?6:n;var l=[];if(1<(s=Math.ceil(e/a))){l.push({type:"prev",number:Math.max(1,t-1),active:1<t}),l.push({type:"first",number:1,active:1<t,current:1===t}),i=Math.round((w.paginationMaxBlocks-w.paginationMinBlocks)/2),o=Math.max(2,t-i),r=Math.min(s-1,t+2*i-(t-o));for(var c=o=Math.max(2,o-(2*i-(r-o)));c<=r;)c===o&&2!==c||c===r&&c!==s-1?l.push({type:"more",active:!1}):l.push({type:"page",number:c,active:t!==c,current:t===c}),c++;l.push({type:"last",number:s,active:t!==s,current:t===s}),l.push({type:"next",number:Math.min(s,t+1),active:t<s})}return l},this.isDataReloadRequired=function(){return!g||!T.equals(r(),o)||a()},this.hasFilter=function(){return 0<Object.keys(this.filter(!0)).length},this.hasGroup=function(t,e){return null==t?c(b.group)||0<Object.keys(b.group).length:c(t)?null==e?b.group===t:b.group===t&&t.sortDirection===e:null==e?-1!==Object.keys(b.group).indexOf(t):b.group[t]===e},this.hasFilterChanges=function(){var t=o&&o.params.filter;return!T.equals(b.filter,t)||a()},this.url=function(a){function t(t,e){a?n.push(e+"="+encodeURIComponent(t)):n[e]=encodeURIComponent(t)}function e(t,e){return"group"===e||void 0!==typeof t&&""!==t}var n=(a=a||!1)?[]:{};for(var r in b)if(b.hasOwnProperty(r)){var i=b[r],o=encodeURIComponent(r);if("object"==typeof i){for(var s in i)if(e(i[s],r)){var l=o+"["+encodeURIComponent(s)+"]";t(i[s],l)}}else!T.isFunction(i)&&e(i,r)&&t(i,o)}return n},this.reload=function(){var e=this,t=null;if(w.$loading=!0,o=T.copy(r()),g=!0,e.hasGroup())t=i(y.when(w.getGroups(e)));else{var a=w.getData;t=i(y.when(a(e)))}f("ngTable: reload data");var n=e.data;return t.then(function(t){return w.$loading=!1,s=null,e.data=t,k.publishAfterReloadData(e,t,n),e.reloadPages(),t}).catch(function(t){return s=o,y.reject(t)})},this.hasErrorState=function(){return!(!s||!T.equals(s,r()))},this.reloadPages=function(){var t=n,e=p.generatePagesArray(p.page(),p.total(),p.count());T.equals(t,e)||(n=e,k.publishPagesChanged(this,e,t))};var b={page:1,count:10,filter:{},sorting:{},group:{}};T.extend(b,x.params);var w={$loading:!1,dataset:null,total:0,defaultSort:"desc",filterOptions:T.copy(h),groupOptions:T.copy({defaultSort:"asc",isExpanded:!0}),counts:[10,25,50,100],interceptors:[],paginationMaxBlocks:11,paginationMinBlocks:5,sortingIndicator:"span"};return this.settings(v),this.settings(x.settings),this.settings(e),this.parameters(t,!0),k.publishAfterCreated(this),T.forEach(m,function(t){t()}),m=null,this}}var T=a(0);n.$inject=["$q","$log","$filter","ngTableDefaults","ngTableDefaultGetData","ngTableEventsChannel"],e.ngTableParamsFactory=n},18,function(t,e,a){var n="ng-table/filterRow.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,'<tr ng-show=show_filter class=ng-table-filters> <th data-title-text="{{$column.titleAlt(this) || $column.title(this)}}" ng-repeat="$column in $columns" ng-if=$column.show(this) class="filter {{$column.class(this)}}" ng-class="params.settings().filterOptions.filterLayout === \'horizontal\' ? \'filter-horizontal\' : \'\'"> <div ng-repeat="(name, filter) in $column.filter(this)" ng-include=config.getTemplateUrl(filter) class=filter-cell ng-class="[getFilterCellCss($column.filter(this), params.settings().filterOptions.filterLayout), $last ? \'last\' : \'\']"> </div> </th> </tr> ')}]),t.exports=n},function(t,e,a){var n="ng-table/filters/number.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,'<input type=number name={{name}} ng-disabled=$filterRow.disabled ng-model=params.filter()[name] class="input-filter form-control" placeholder="{{getFilterPlaceholderValue(filter, name)}}"/> ')}]),t.exports=n},function(t,e,a){var n="ng-table/filters/select-multiple.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,'<select ng-options="data.id as data.title for data in $column.data" ng-disabled=$filterRow.disabled multiple=multiple ng-multiple=true ng-model=params.filter()[name] class="filter filter-select-multiple form-control" name={{name}}> </select> ')}]),t.exports=n},function(t,e,a){var n="ng-table/filters/select.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,'<select ng-options="data.id as data.title for data in $selectData" ng-table-select-filter-ds=$column ng-disabled=$filterRow.disabled ng-model=params.filter()[name] class="filter filter-select form-control" name={{name}}> <option style=display:none value=""></option> </select> ')}]),t.exports=n},function(t,e,a){var n="ng-table/filters/text.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,'<input type=text name={{name}} ng-disabled=$filterRow.disabled ng-model=params.filter()[name] class="input-filter form-control" placeholder="{{getFilterPlaceholderValue(filter, name)}}"/> ')}]),t.exports=n},function(t,e,a){var n="ng-table/groupRow.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,'<tr ng-if=params.hasGroup() ng-show=$groupRow.show class=ng-table-group-header> <th colspan={{getVisibleColumns().length}} class=sortable ng-class="{\n                    \'sort-asc\': params.hasGroup($selGroup, \'asc\'),\n                    \'sort-desc\':params.hasGroup($selGroup, \'desc\')\n                  }"> <a href="" ng-click="isSelectorOpen = !isSelectorOpen" class=ng-table-group-selector> <strong class=sort-indicator>{{$selGroupTitle}}</strong> <button class="btn btn-default btn-xs ng-table-group-close" ng-click="$groupRow.show = false; $event.preventDefault(); $event.stopPropagation();"> <span class="glyphicon glyphicon-remove"></span> </button> <button class="btn btn-default btn-xs ng-table-group-toggle" ng-click="toggleDetail(); $event.preventDefault(); $event.stopPropagation();"> <span class=glyphicon ng-class="{\n                    \'glyphicon-resize-small\': params.settings().groupOptions.isExpanded,\n                    \'glyphicon-resize-full\': !params.settings().groupOptions.isExpanded\n                }"></span> </button> </a> <div class=list-group ng-if=isSelectorOpen> <a href="" class=list-group-item ng-repeat="group in getGroupables()" ng-click=groupBy(group)> <strong>{{ getGroupTitle(group)}}</strong> <strong ng-class="isSelectedGroup(group) && \'sort-indicator\'"></strong> </a> </div> </th> </tr> ')}]),t.exports=n},function(t,e,a){var n="ng-table/header.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,"<ng-table-group-row></ng-table-group-row> <ng-table-sorter-row></ng-table-sorter-row> <ng-table-filter-row></ng-table-filter-row> ")}]),t.exports=n},function(t,e,a){var n="ng-table/pager.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,'<div class="ng-cloak ng-table-pager" ng-if=params.data.length> <div ng-if=params.settings().counts.length class="ng-table-counts btn-group pull-right"> <button ng-repeat="count in params.settings().counts" type=button ng-class="{\'active\':params.count() == count}" ng-click=params.count(count) class="btn btn-default"> <span ng-bind=count></span> </button> </div> <ul ng-if=pages.length class="pagination ng-table-pagination"> <li ng-class="{\'disabled\': !page.active && !page.current, \'active\': page.current}" ng-repeat="page in pages" ng-switch=page.type> <a ng-switch-when=prev ng-click=params.page(page.number) href="">&laquo;</a> <a ng-switch-when=first ng-click=params.page(page.number) href=""><span ng-bind=page.number></span></a> <a ng-switch-when=page ng-click=params.page(page.number) href=""><span ng-bind=page.number></span></a> <a ng-switch-when=more ng-click=params.page(page.number) href="">&#8230;</a> <a ng-switch-when=last ng-click=params.page(page.number) href=""><span ng-bind=page.number></span></a> <a ng-switch-when=next ng-click=params.page(page.number) href="">&raquo;</a> </li> </ul> </div> ')}]),t.exports=n},function(t,e,a){var n="ng-table/sorterRow.html";a(0).module("ng").run(["$templateCache",function(t){t.put(n,"<tr class=ng-table-sort-header> <th title={{$column.headerTitle(this)}} ng-repeat=\"$column in $columns\" ng-class=\"{\n                    'sortable': $column.sortable(this),\n                    'sort-asc': params.sorting()[$column.sortable(this)]=='asc',\n                    'sort-desc': params.sorting()[$column.sortable(this)]=='desc'\n                  }\" ng-click=\"sortBy($column, $event)\" ng-if=$column.show(this) ng-init=\"template = $column.headerTemplateURL(this)\" class=\"header {{$column.class(this)}}\"> <div ng-if=!template class=ng-table-header ng-class=\"{'sort-indicator': params.settings().sortingIndicator == 'div'}\"> <span ng-bind=$column.title(this) ng-class=\"{'sort-indicator': params.settings().sortingIndicator == 'span'}\"></span> </div> <div ng-if=template ng-include=template></div> </th> </tr> ")}]),t.exports=n},function(t,a,e){"use strict";function n(t){for(var e in t)a.hasOwnProperty(e)||(a[e]=t[e])}var r=e(0),i=e(2),o=e(1),s=r.module("ngTable",[i.default.name,o.default.name]);a.ngTable=s,n(e(2)),n(e(1))}]))}),angular.module("obrasMduytApp").run(["$templateCache",function(t){"use strict";t.put("views/buscador.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">{{ i18n.loading }}</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row"> <table id="buscador-table" ng-table-dynamic="tableParams with cols" class="table table-responsive"> <tr ng-repeat="row in $data"> </tr> </table> </div> <div class="row"> <h2 ng-show="results.length==0" class="text-center">{{ i18n.noResults }}</h2> <div class="col-sm-12 well resultado-buscador" ng-repeat="o in results"> <div class="row"> <div class="col-sm-3"> <img ng-show="o.imagen_1" ng-src="{{o.imagen_1}}" class="img-responsive"> <img ng-hide="o.imagen_1" ng-src="http://placehold.it/400x300" class="img-responsive"> </div> <div class="col-sm-9"> <div class="row"> <div class="col-sm-6"> <span class="title">{{ i18n.plannedWork }}:</span> <span class="desc">{{o.nombre}}</span> </div> <div class="col-sm-3" ng-if="o.licitacion_oferta_empresa"> <span class="title">{{ i18n.company }}:</span> <span class="desc">{{o.licitacion_oferta_empresa}}</span> </div> <div class="col-sm-3" ng-if="o.monto_contrato"> <span class="title">{{ i18n.investmentAmount }}:</span> <span class="desc">{{o.monto_contrato | currency}}</span> </div> </div> <div class="row"> <div class="col-sm-12"> <span class="title">{{ i18n.description }}:</span> <span class="desc">{{o.descripcion}}</span> </div> </div> <div class="row"> <div class="col-sm-2" ng-if="o.area_responsable"> <span class="title">{{ i18n.responsableArea }}:</span> <span class="desc">{{o.area_responsable}}</span> </div> <div class="col-sm-2" ng-if="o.tipo"> <span class="title">{{ i18n.type }}:</span> <span class="desc">{{o.tipo}}</span> </div> <div class="col-sm-2" ng-if="o.comuna"> <span class="title">{{ i18n.commune }}:</span> <span class="desc">{{ i18n.commune }} {{o.comuna}}</span> </div> <div class="col-sm-2" ng-if="o.etapa"> <span class="title">{{ i18n.stage }}:</span> <span class="desc">{{o.etapa}}</span> </div> <div class="col-sm-3 col-sm-offset-1"> <a ng-show="o.link_interno" ng-href="{{o.link_interno}}" target="_parent" class="btn btn-default btn-block">{{ i18n.moreInformation }}</a> </div> </div> </div> </div> </div> </div> <div class="row"> <div id="footer" class="col-sm-12"> </div> </div> </div> '),t.put("views/directives/youtubePlayer.html",'<div class="detalle-frame {{class}}"> <p class="detalle-frame-title text-left" ng-if="title">{{title}} </p> <i ng-if="nota || fuente" class="detalle-frame-icon glyphicon glyphicon-info-sign" data-container="body" title="{{nota}}" data-toggle="popover" data-placement="bottom" data-content="Fuente: {{fuente}}"> </i> <span ng-show="loading">Cargando...</span> <a class="yt-switch" href="javascript:;" ng-click="ytSwitch=true;" ng-hide="ytSwitch" ng-style="{\'background-image\':\'url(\'+ytThumbnail+\')\'}"> <img class="img-responsive" src="images/play.png"> </a> <ng-youtube-embed ng-if="ytSwitch" url="url" playauto="true" color="white" disablekb="true" width="100%" height="300px" rel="false" theme="light" modestbranding="1"> </ng-youtube-embed> </div> '),t.put("views/entorno.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">{{ i18n.loading }}</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row"> <div class="col-md-12"> <h2>{{ i18n.environment }}: {{obras[0].entorno}}</h2> <div ng-repeat="obra in obras"> \x3c!-- Obra: {{$index+1}} -> {{obra}} --\x3e <div ng-include="\'views/includes/obra-detail.html\'"></div> </div> </div> </div> <div class="row"> <div class="col-md-12"> <h4>{{ i18n.mapLocation }}</h4> <leaflet center="center" tiles="tiles" markers="markers" defaults="defaults" width="100%" height="350px"></leaflet> </div> </div> </div> '),t.put("views/home.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">{{ i18n.loading }}</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row"> <div class="col-sm-12"> <stats-home obras="obras"></stats-home> </div> </div> <div class="hidden-xs"> <selector-home ng-if="availableGroups.length > 1" list="availableGroups" selected-group="selectedGroup" update-fn="changeGroup(group)"></selector-home> </div> <div class="row hidden-xs"> <div class="col-sm-12"> <tipo-chart labels="labels" obras="obras" selected-filter="selectedFilter" filter-fn="filterBubbles(filter)" tipo-colors="tipo_colors" finish-fn="tipoChartFinished()"></tipo-chart> </div> </div> <div class="row hidden-xs"> <div class="col-sm-12"> <area-responsable-chart obras="obras" selected-filter="selectedFilter" filter-fn="filterBubbles(filter)"></area-responsable-chart> </div> </div> <div class="row"> <div class="col-sm-12"> <h1 class="hidden-xs"> <strong>{{ useComunas ? "Conocé las obras de tu comuna" : i18n.mapTitle }}</strong></h1> <h1 class="visible-xs"> <strong>{{ useComunas ? " Tocá una comuna para conocer las obras" : i18n.mobileMapTitle }}</strong></h1> </div> </div> <div class="row hidden-xs"> <div class="col-md-12"> <div id="search-box" class="row chart-item"> <div class="col-md-2 hidden-xs"> <h4>{{ i18n.searchBy }}</h4> </div> <div class="col-xs-12 col-md-8 search"> <input ng-model="textFilter" ng-change="filterByText()" class="form-control text-filter" type="text" placeholder="Filtra por nombre o descripcion de obra"> </div> </div> </div> </div> <div id="main-chart-container" class="row"> <div class="hidden-xs col-sm-12"> <a ng-click="filterBubbles(\'destacada\')" class="btn btn btn-secondary btn-sm show-destacadas"><i class="glyphicon glyphicon-flag"></i>{{ i18n.featuredWorks }}</a> <p> </p> <p> </p> </div> </div> <div class="col-sm-12 home-chart-main"> <div id="home-chart-container"></div> </div> </div> <div id="mobile-filler" class="row"> </div>  \x3c!-- Tooltip OBRAS --\x3e <div id="tooltip-home-chart"> <button type="button" class="close pull-right" ng-click="closeTooltip()">&times;</button> <div class="row"> <div class="col-xs-12"> <div id="tooltip-logo-container" class="pull-left"></div> <div class="tooltip-title"> <span class="type" ng-style="{color: selectedObra.color_tipo_obra}">{{selectedObra.data.tipo}}</span> <span class="title">{{selectedObra.data.nombre}}</span> </div> </div> </div> <div class="tooltip-img" ng-show="tooltipThumb"> <img class="obra-pic img-responsive" ng-src="{{tooltipThumb}}"> </div> <div class="row"> <div class="col-xs-12"> <div ng-show="selectedObra.data.porcentaje_avance" class="progress"> <span class="desc">{{selectedObra.data.etapa}}<span ng-show="selectedObra.data.porcentaje_avance">: {{selectedObra.data.porcentaje_avance}}%</span></span> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': selectedObra.data.porcentaje_avance + \'%\' }"> <i ng-show="selectedObra.data.porcentaje_avance == 100" class="glyphicon glyphicon-ok"></i> </div> <div class="progress-w" ng-show="selectedObra.data.porcentaje_avance<22" ng-style="{ \'width\': (100 - selectedObra.data.porcentaje_avance) + \'%\' }"></div> </div> </div> </div> <div class="hidden-xs"> <div class="row tooltip-text" ng-show="selectedObra.data.area_responsable"> <div class="col-xs-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-xs-10"> <p class="tooltip-text">{{selectedObra.data.area_responsable}}</p> </div> </div> <p class="tooltip-text tooltip-map" ng-show="showObraImg"> <span class="tooltip-map-loading" ng-show="!selectedObra.map"><small>{{ i18n.loading }}</small></span> <span class="tooltip-map-placeholder"> <img class="obra-pic img-responsive" ng-show="selectedObra.map" ng-src="{{selectedObra.map}}"> </span> </p> <div class="row tooltip-text" ng-show="selectedObra.data.direccion"> <div class="col-xs-2"> <img src="images/iconos/location.svg"> </div> <div class="col-xs-10"> <p class="tooltip-text">{{selectedObra.data.direccion}}<br>Comuna {{selectedObra.data.comuna}}</p> </div> </div> </div> <p class="tooltip-text" ng-show="selectedObra.data.link_interno"><a target="_parent" ng-href="{{selectedObra.data.link_interno}}" class="btn btn-link btn-xs btn-block btn-ver-mas">{{ i18n.seeMore }}</a></p> <div class="row compromiso-row" ng-show="selectedObra.data.compromiso"> <div class="col-xs-12"> <span class="label label-primary">{{ i18n.governmentCommitment }}</span> </div> </div> </div> \x3c!-- TODO: adaptar todo lo siguiente --\x3e <div ng-show="showList" class="row obra-list open-big"> <div class="grey-back col-xs-12"> <div class="row"> <h4 class="col-xs-10">{{ i18n.totalWorks }} {{ selectedComuna ? "Comuna " + selectedComuna : selectedJurisdiccion }}</h4> <h4 class="col-xs-2 right"><a href="" ng-click="closeList()"> <span class="ba-icon ba-no form-control-feedback"></span></a> </h4> </div> </div> <div class="light-grey-back col-xs-12" style="display: none"> <div class="row"> <div class="col-xs-2"> <p>Filtrar:</p> </div> <div class="col-xs-8"> <select class="input" ng-options="item as item.label for item in selectTypes track by item.slug" ng-model="obrasTypeFilter"></select> </div> </div> <div class="row"> <div class="col-xs-2"> <p></p> </div> <div class="col-xs-8"> <input ng-model="obrasListFilter" type="text" placeholder="Palabra Clave"><p></p> </div> </div> </div> <div class="detail col-xs-12" ng-repeat="o in filteredObras | filter:obrasListFilter || obrasTypeFilter.slug"> <div class="row full"> <div class="col-xs-4"> <img class="obra-pic img-responsive" ng-src="{{o.thumb}}"> </div> <div class="col-xs-8"> <div class="row"> <h5> {{o.nombre}} </h5> <p> {{o.descripcion | limitTo:250}}</p> <div class="row data"> <div class="col-xs-6 smaller"> <div class="row"> <div class="col-xs-5"><p>Monto:</p></div> <div class="col-xs-7"> {{o.monto_contrato | currency}}</div> </div> <div class="row"> <div class="col-xs-5"><p>Etapa:</p></div> <div class="col-xs-7">{{o.etapa}}</div> </div> </div> <div class="col-xs-6"> <p class="tooltip-text right" ng-show="o.link_interno"><a target="_parent" ng-href="{{o.link_interno}}" class="btn btn-link btn-xs btn-block btn-ver-mas">VER MÁS</a></p> </div> </div> </div> </div> </div> </div> </div>'),t.put("views/includes/home-area.html",'<div id="area-responsable-chart" class="row chart-item" ng-show="total_obras_by_area.length"> <div class="col-md-2"><h4>{{ i18n.filterByGovernmentArea }}</h4></div> <div class="col-md-5"> <select ng-show="total_obras_by_area.length" id="areas" class="form-control" ng-model="selected"> <option value="">{{ i18n.all }}</option> <option ng-repeat="option in total_obras_by_area" value="{{option.slug}}">{{option.area}}</option> </select> </div> <div class="col-md-5"> <div id="mini-chart" ng-class="{\'all\':selected==\'\'}"></div> <p ng-show="selectedCantidad">{{selectedCantidad}} {{ i18n.plannedWorks }} <span ng-show="selectedCantidad!=total">({{selectedCantidad*100/total | number:0}}% {{ i18n.ofTheTotal }})</span> </p></div> </div> '),t.put("views/includes/obra-detail.html",'<div class="row obra"> <div class="col-md-12"> <h3>{{ i18n.plannedWork }}: {{obra.nombre}}</h3> <div class="row"> <div class="col-md-8"> <ul> <flex-slider slide="s in obra.fotos" animation="slide" control-nav="thumbnails"> <li data-thumb="{{s}}"> <img ng-src="{{s}}"> </li> </flex-slider> </ul> <p> {{obra.descripcion}} </p> </div> <div class="col-md-3 ficha-tecnica" ng-if="obra.hasDetail"> <h4>{{ i18n.technicalInformation }}</h4> <p class="etiquetas"> <a href="http://www.buenosaires.gob.ar/compromisos" target="_blank>"><span ng-show="obra.compromiso" class="label label-primary compromiso-row compromiso"> <img src="images/iconos/compromiso.svg">{{ i18n.governmentCommitment }}</span></a> <span ng-show="obra.destacada" class="label label-primary compromiso-row destacada"> <img src="images/iconos/archivo.svg">{{ i18n.featuredWork }}</span> <a href="https://baelige.buenosaires.gob.ar/" target="_blank>"> <span ng-show="obra.ba_elige" class="label label-primary compromiso-row ba-elige"> <img src="images/iconos/archivo.svg">BA Elige</span></a> </p> <div class="etapa" ng-if="obra.etapa"> <div class="row"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p>{{ i18n.stage }}:</p> <p><strong>{{obra.etapa}}</strong> </p> <div class="progress" ng-if="obra.porcentaje_avance"> <div class="progress-bar bg-color-{{obra.slug}}" role="progressbar" ng-style="{ \'width\': obra.porcentaje_avance + \'%\' }"> <div class="progressbar-w" ng-show="!obra.porcentaje_avance"><p></p> </div> <span class="progressbar-w" ng-hide="obra.porcentaje_avance<22 || !obra.porcentaje_avance"> </span> </div> <div class="progress-w" ng-show="obra.porcentaje_avance<22" ng-style="{ \'width\': (100 - obra.porcentaje_avance) + \'%\' }"></div> </div> <div ng-if="!obra.hideDates" class="row fechas" ng-show="obra.fecha_inicio"> <div class="col-md-6" ng-show="obra.fecha_inicio"> <p> {{ i18n.start }}: <strong>{{obra.fecha_inicio}}</strong></p> </div> <div class="col-md-6" ng-show="obra.fecha_fin"> <p> {{ i18n.end }}: <strong>{{obra.fecha_fin}}</strong> </p> </div> </div> </div> </div> <div class="row" ng-if="obra.etapa_detalle"> <div class="col-md-2"> <p> </p> </div> <div class="col-md-10"> <p> <small> {{obra.etapa_detalle}}</small> </p> </div> </div> </div> <div class="row" ng-if="obra.tipo"> <div class="col-md-2"> <img src="images/iconos/estilo.svg"> </div> <div class="col-md-10"> <p>{{ i18n.workType }}: </p> <strong>{{obra.tipo}}</strong> </div> </div> <div class="row"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10" ng-if="obra.area_responsable"> <p> {{ i18n.responsableArea }}: </p> <strong> {{obra.area_responsable}}</strong> </div> </div> <div class="row" ng-show="obra.licitacion_oferta_empresa"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p> {{ i18n.company }}: </p> <strong> {{obra.licitacion_oferta_empresa}}</strong> <div ng-show="obra.cuit_contratista"> <p> CUIT Empresa: </p> <strong> {{obra.cuit_contratista}}</strong> </div> <div ng-show="obra.contratacion_tipo"> <p> {{ i18n.contractType }}: </p> <strong> {{obra.contratista_tipo}}</strong> </div> <div ng-show="obra.nro_contratacion"> <p> {{ i18n.contractNumber }}: </p> <strong> {{obra.nro_contratacion}}</strong> </div> </div> </div> <div class="row" ng-show="obra.plazo_meses" ng-if="obra.plazo_meses"> <div class="col-md-2"> <img src="images/iconos/relojarena.svg"> </div> <div class="col-md-10"> <p> {{ i18n.termDuration }}: </p> <strong> {{obra.plazo_meses}} {{ i18n.months }} </strong> </div> </div> <div class="row" ng-show="obra.hideDates && obra.licitacion_anio"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p>{{ i18n.yearOfTender }}: </p> <strong> {{obra.licitacion_anio}}</strong> </div> </div> <div class="row" ng-show="obra.beneficiarios" ng-if="obra.benficiarios"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p>{{ i18n.numberOfBeneficiaries }}:</p> <strong> {{obra.benficiarios}}<small> {{ i18n.people }}</small> </strong> </div> </div> <div class="row" ng-show="obra.mano_obra" ng-if="obra.mano_obra"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p>{{ i18n.workforce }}: </p> <strong> {{obra.mano_obra}} <small>{{ i18n.people }}</small> </strong> <colored-icons scale="\'manoDeObra\'" callback="drawSecondColored"></colored-icons> </div> </div> <div class="row" ng-show="obra.monto_contrato" ng-if="obra.monto_contrato"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>{{ i18n.contractAmount }}: </p> <strong> {{obra.monto_contrato | currency}} </strong> </div> </div> <div class="row" ng-show="obra.direccion" ng-if="obra.direccion"> <div class="col-md-2"> <img src="images/iconos/location.svg"> </div> <div class="col-md-10"> <p> {{ i18n.address }}: </p> <strong> {{obra.direccion}} </strong> </div> </div> <div class="row" ng-show="obra.licitacion_presupuesto_oficial"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>{{ i18n.updatedAmount }}: </p> <strong> {{obra.licitacion_presupuesto_oficial | currency}} </strong> </div> </div> <div class="row" ng-show="obra.financiamiento"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>{{ i18n.financer }}:</p> <strong>{{obra.financiamiento}}</strong> </div> </div> <div class="row" ng-show="obra.pliego_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.pliego_descarga}}" target="_blank">{{ i18n.contractInformation }}</a> </p> </div> </div> <div class="row" ng-show="obra.estudio_ambiental_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.estudio_ambiental_descarga}}" target="_blank">{{ i18n.environmentalImpact }}</a> </p> </div> </div> </div> </div> </div> </div> '),t.put("views/includes/stats-home.html",'<div> <div class="row" ng-show="obras"> <div class="col-xs-12"> <h1 class="center">{{ i18n.homeTitle }}</h1> </div> </div> <div id="stats-home" class="row" ng-show="obras"> <div class="col-xs-12"> <div class="row"> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/inversion.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>{{ i18n.investmentAmount }}:</h5> <span class="value">{{totalRender.inversion | currency:$ :0}}</span> </div> </div> </div> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/obras.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>{{ i18n.totalWorks }}:</h5> <span class="value">{{totalRender.obras | number:0}}</span> </div> </div> </div> </div> <div class="row"> <div class="col-xs-6"> <div class="row"> </div> </div> <div class="col-xs-6"> <div class="row"> </div> </div> </div> </div> </div> </div>'),t.put("views/includes/stats-home2.html",'<div> <div class="row" ng-show="obras"> <div class="col-xs-12"> <h1 class="center">{{ i18n.homeTitle }}</h1> </div> </div> <div id="stats-home" class="row" ng-show="obras"> <div class="col-xs-12"> <div class="row"> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/inversion.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>{{ i18n.investmentAmount }}:</h5> <span class="value">{{totalRender.inversion | currency:$ :0}}</span> </div> </div> </div> <div class="col-xs-6"> <div class="row"> <div class="col-xs-3 col-md-4 icon-container"> <img class="" src="images/indicadores/obras.svg"> </div> <div class="col-xs-9 col-md-8 value-container"> <h5>{{ i18n.totalWorks }}:</h5> <span class="value">{{totalRender.obras | number:0}}</span> </div> </div> </div> </div> <div class="row"> <div class="col-xs-6"> <div class="row"> </div> </div> <div class="col-xs-6"> <div class="row"> </div> </div> </div> </div> </div> </div>'),t.put("views/includes/youtubePlayer.html",'<div class="detalle-frame {{class}}"> <p class="detalle-frame-title text-left" ng-if="title">{{title}} </p> <i ng-if="nota || fuente" class="detalle-frame-icon glyphicon glyphicon-info-sign" data-container="body" title="{{nota}}" data-toggle="popover" data-placement="bottom" data-content="Fuente: {{fuente}}"> </i> <span ng-show="loading">Cargando...</span> <a class="yt-switch" href="javascript:;" ng-click="ytSwitch=true;" ng-hide="ytSwitch" ng-style="{\'background-image\':\'url(\'+ytThumbnail+\')\'}"> <img class="img-responsive" src="images/play.png"> </a> <ng-youtube-embed ng-if="ytSwitch" url="url" playauto="true" color="white" disablekb="true" width="100%" height="300px" rel="false" theme="light" modestbranding="1"> </ng-youtube-embed> </div> '),t.put("views/obra.html",'<div ng-show="loading" class="row"> <div class="col-sm-12"> <h1 id="loading" class="text-center">{{ i18n.loading }}</h1> <p class="text-center"><img src="images/loader.75526f36.gif"></p> <hr> </div> </div> <div ng-if="!loading"> <div class="row obra"> <div class="col-xs-12"> <div class="row"> <div class="col-xs-12"> <div class="tooltip-title"> <div class="row"> <div class="col-xs-1"> <div class="inner"> <div id="tooltip-logo-container" class="icon pull-left" ng-style="{\'background-color\': tipo_colors(obra.tipo)}"> <img ng-src="images/iconos/{{obra.tipo_slug}}.svg"> </div> </div> </div> <div class="col-xs-10"> <p class="type" ng-style="{color: tipo_colors(obra.tipo)}">{{obra.tipo}}</p> <h3 class="title">{{obra.nombre}}</h3> </div> </div> </div> </div> </div> <div class="row"> <div class="col-md-8"> <ul> <flex-slider slide="s in obra.fotos" animation="slide" control-nav="thumbnails"> <li data-thumb="{{s}}"> <img ng-src="{{s}}"> </li> </flex-slider> </ul> <p> {{c.descripcion}} </p> </div> <div class="col-md-3 ficha-tecnica"> <h4>{{ i18n.technicalInformation }}</h4> <p class="etiquetas"> <a href="http://www.buenosaires.gob.ar/compromisos" target="_blank>"><span ng-show="obra.compromiso" class="label label-primary compromiso-row compromiso"> <img src="images/iconos/compromiso.svg">{{ i18n.governmentCommitment }}</span></a> <span ng-show="obra.destacada" class="label label-primary compromiso-row destacada"> <img src="images/iconos/archivo.svg">{{ i18n.featuredWork }}</span> <a href="https://baelige.buenosaires.gob.ar/" target="_blank>"> <span ng-show="obra.ba_elige" class="label label-primary compromiso-row ba-elige"> <img src="images/iconos/archivo.svg">BA Elige</span></a> </p> <div class="etapa"> <div class="row" ng-show="obra.etapa"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p>{{ i18n.stage }}:</p> <p><strong>{{obra.etapa}}</strong> </p> <div class="progress" ng-show="obra.porcentaje_avance"> <div class="progress-bar bg-color-{{obra.slug}}" role="progressbar" ng-style="{ \'width\': obra.porcentaje_avance + \'%\' }"> <div class="progressbar-w" ng-show="!obra.porcentaje_avance"> <p></p> </div> <span class="progressbar-w" ng-hide="obra.porcentaje_avance<22 || !obra.porcentaje_avance"></span> </div> <div class="progress-w" ng-show="obra.porcentaje_avance<22" ng-style="{ \'width\': (100 - obra.porcentaje_avance) + \'%\' }"> </div> </div> <div ng-if="!obra.hideDates" class="row fechas" ng-show="obra.fecha_inicio"> <div class="col-md-6" ng-show="obra.fecha_inicio"> <p> {{ i18n.start }}: <strong>{{obra.fecha_inicio}}</strong></p> </div> <div class="col-md-6" ng-show="obra.fecha_fin"> <p> {{ i18n.end }}: <strong>{{obra.fecha_fin}}</strong> </p> </div> </div> </div> </div> <div class="row"> <div class="col-md-2"> <p> </p> </div> <div class="col-md-10"> <p> <small> {{obra.etapa_detalle}}</small> </p> </div> </div> <div class="row" ng-show="obra.tipo"> <div class="col-md-2"> <img src="images/iconos/estilo.svg"> </div> <div class="col-md-10"> <p> {{ i18n.workType }}: </p> <strong>{{obra.tipo}}</strong> </div> </div> <div class="row" ng-show="obra.area_responsable"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p> {{ i18n.responsableArea }}: </p> <strong> {{obra.area_responsable}}</strong> </div> </div> <div class="row" ng-show="obra.licitacion_oferta_empresa"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p> {{ i18n.company }}: </p> <strong> {{obra.licitacion_oferta_empresa}}</strong> <div ng-show="obra.cuit_contratista"> <p> CUIT Empresa: </p> <strong> {{obra.cuit_contratista}}</strong> </div> <div ng-show="obra.contratacion_tipo"> <p> {{ i18n.contractType }}: </p> <strong> {{obra.contratista_tipo}}</strong> </div> <div ng-show="obra.nro_contratacion"> <p> {{ i18n.contractNumber }}: </p> <strong> {{obra.nro_contratacion}}</strong> </div> </div> </div> <div class="row" ng-show="obra.plazo_meses"> <div class="col-md-2"> <img src="images/iconos/relojarena.svg"> </div> <div class="col-md-10"> <p> {{ i18n.termDuration }}: </p> <strong> {{obra.plazo_meses}} {{ i18n.months }} </strong> </div> </div> <div class="row" ng-show="obra.hideDates && obra.licitacion_anio"> <div class="col-md-2"> <img src="images/iconos/calendario.svg"> </div> <div class="col-md-10"> <p>{{ i18n.yearOfTender }}:</p> <strong> {{obra.licitacion_anio}}</strong> </div> </div> <div class="row" ng-show="obra.beneficiarios"> <div class="col-md-2"> <img src="images/iconos/ministerio.svg"> </div> <div class="col-md-10"> <p>{{ i18n.numberOfBeneficiaries }}:</p> <strong> {{obra.benficiarios}}<small> {{ i18n.people }}</small> </strong> </div> </div> <div class="row" ng-show="obra.mano_obra"> <div class="col-md-2"> <img src="images/iconos/trabajador.svg"> </div> <div class="col-md-10"> <p>{{ i18n.workforce }}: </p> <strong> {{obra.mano_obra}} <small>{{ i18n.people }}</small> </strong> <colored-icons scale="\'manoDeObra\'" callback="drawSecondColored"></colored-icons> </div> </div> <div class="row" ng-show="obra.monto_contrato"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>{{ i18n.contractAmount }}: </p> <strong> {{obra.monto_contrato | currency}} </strong> </div> </div> <div class="row" ng-show="obra.direccion"> <div class="col-md-2"> <img src="images/iconos/location.svg"> </div> <div class="col-md-10"> <p>{{ i18n.address }}: </p> <strong> {{obra.direccion}} </strong> </div> </div> <div class="row" ng-show="obra.licitacion_presupuesto_oficial"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>{{ i18n.updatedAmount }}: </p> <strong> {{obra.licitacion_presupuesto_oficial | currency}} </strong> </div> </div> <div class="row" ng-show="obra.financiamiento"> <div class="col-md-2"> <img src="images/iconos/dinero.svg"> </div> <div class="col-md-10"> <p>{{ i18n.financer }}:</p> <strong>{{obra.financiamiento}}</strong> </div> </div> <div class="row" ng-show="obra.pliego_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.pliego_descarga}}" target="_blank">{{ i18n.contractInformation }}</a> </p> </div> </div> <div class="row" ng-show="obra.estudio_ambiental_descarga"> <div class="col-md-2"> <img src="images/iconos/archivo.svg"> </div> <div class="col-md-10"> <p><a ng-href="{{obra.estudio_ambiental_descarga}}" target="_blank">{{ i18n.environmentalImpact }}</a> </p> </div> </div> </div> \x3c!-- etapa --\x3e </div> \x3c!-- ficha técnica --\x3e </div> \x3c!-- row --\x3e <div class="row"> <div class="col-md-12"> <h4>{{ i18n.workLocation }} </h4> <leaflet center="center" tiles="tiles" markers="markers" defaults="defaults" width="100%" height="350px"></leaflet> </div> </div> </div>\x3c!-- col md 12 --\x3e </div>\x3c!-- row obra --\x3e </div>\x3c!-- if loading --\x3e ')}]);